TODO: obv async loop and using async methods
