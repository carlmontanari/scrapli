
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="Fast, flexible, sync/async, Python 3.7+ screen scraping client specifically for network devices">
      
      
        <meta name="author" content="Carl Montanari">
      
      
        <link rel="canonical" href="https://carlmontanari.github.io/reference/channel/async_channel/">
      
      <link rel="icon" href="../../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.4.0, mkdocs-material-8.5.3">
    
    
      
        <title>async_channel - Scrapli</title>
      
    
    
      <link rel="stylesheet" href="../../../assets/stylesheets/main.7a952b86.min.css">
      
        
        <link rel="stylesheet" href="../../../assets/stylesheets/palette.cbb835fc.min.css">
        
          
          
          <meta name="theme-color" content="#000000">
        
      
      

    
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../../assets/_mkdocstrings.css">
    
    <script>__md_scope=new URL("../../..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="" data-md-color-primary="black" data-md-color-accent="teal">
  
    
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#channel.async_channel" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../../.." title="Scrapli" class="md-header__button md-logo" aria-label="Scrapli" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Scrapli
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              async_channel
            
          </span>
        </div>
      </div>
    </div>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/carlmontanari/scrapli" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 480 512"><!--! Font Awesome Free 6.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M186.1 328.7c0 20.9-10.9 55.1-36.7 55.1s-36.7-34.2-36.7-55.1 10.9-55.1 36.7-55.1 36.7 34.2 36.7 55.1zM480 278.2c0 31.9-3.2 65.7-17.5 95-37.9 76.6-142.1 74.8-216.7 74.8-75.8 0-186.2 2.7-225.6-74.8-14.6-29-20.2-63.1-20.2-95 0-41.9 13.9-81.5 41.5-113.6-5.2-15.8-7.7-32.4-7.7-48.8 0-21.5 4.9-32.3 14.6-51.8 45.3 0 74.3 9 108.8 36 29-6.9 58.8-10 88.7-10 27 0 54.2 2.9 80.4 9.2 34-26.7 63-35.2 107.8-35.2 9.8 19.5 14.6 30.3 14.6 51.8 0 16.4-2.6 32.7-7.7 48.2 27.5 32.4 39 72.3 39 114.2zm-64.3 50.5c0-43.9-26.7-82.6-73.5-82.6-18.9 0-37 3.4-56 6-14.9 2.3-29.8 3.2-45.1 3.2-15.2 0-30.1-.9-45.1-3.2-18.7-2.6-37-6-56-6-46.8 0-73.5 38.7-73.5 82.6 0 87.8 80.4 101.3 150.4 101.3h48.2c70.3 0 150.6-13.4 150.6-101.3zm-82.6-55.1c-25.8 0-36.7 34.2-36.7 55.1s10.9 55.1 36.7 55.1 36.7-34.2 36.7-55.1-10.9-55.1-36.7-55.1z"/></svg>
  </div>
  <div class="md-source__repository">
    carlmontanari/scrapli
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../../.." title="Scrapli" class="md-nav__button md-logo" aria-label="Scrapli" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    Scrapli
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/carlmontanari/scrapli" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 480 512"><!--! Font Awesome Free 6.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M186.1 328.7c0 20.9-10.9 55.1-36.7 55.1s-36.7-34.2-36.7-55.1 10.9-55.1 36.7-55.1 36.7 34.2 36.7 55.1zM480 278.2c0 31.9-3.2 65.7-17.5 95-37.9 76.6-142.1 74.8-216.7 74.8-75.8 0-186.2 2.7-225.6-74.8-14.6-29-20.2-63.1-20.2-95 0-41.9 13.9-81.5 41.5-113.6-5.2-15.8-7.7-32.4-7.7-48.8 0-21.5 4.9-32.3 14.6-51.8 45.3 0 74.3 9 108.8 36 29-6.9 58.8-10 88.7-10 27 0 54.2 2.9 80.4 9.2 34-26.7 63-35.2 107.8-35.2 9.8 19.5 14.6 30.3 14.6 51.8 0 16.4-2.6 32.7-7.7 48.2 27.5 32.4 39 72.3 39 114.2zm-64.3 50.5c0-43.9-26.7-82.6-73.5-82.6-18.9 0-37 3.4-56 6-14.9 2.3-29.8 3.2-45.1 3.2-15.2 0-30.1-.9-45.1-3.2-18.7-2.6-37-6-56-6-46.8 0-73.5 38.7-73.5 82.6 0 87.8 80.4 101.3 150.4 101.3h48.2c70.3 0 150.6-13.4 150.6-101.3zm-82.6-55.1c-25.8 0-36.7 34.2-36.7 55.1s10.9 55.1 36.7 55.1 36.7-34.2 36.7-55.1-10.9-55.1-36.7-55.1z"/></svg>
  </div>
  <div class="md-source__repository">
    carlmontanari/scrapli
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../.." class="md-nav__link">
        Scrapli
      </a>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_2" type="checkbox" id="__nav_2" >
      
      
      
      
        <label class="md-nav__link" for="__nav_2">
          User Guide
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="User Guide" data-md-level="1">
        <label class="md-nav__title" for="__nav_2">
          <span class="md-nav__icon md-icon"></span>
          User Guide
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../user_guide/quickstart/" class="md-nav__link">
        Quick Start Guide
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../user_guide/project_details/" class="md-nav__link">
        Project Details
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../user_guide/versioning/" class="md-nav__link">
        Versioning
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../user_guide/installation/" class="md-nav__link">
        Installation
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../user_guide/basic_usage/" class="md-nav__link">
        Basic Usage
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../user_guide/advanced_usage/" class="md-nav__link">
        Advanced Usage
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../user_guide/linting_testing/" class="md-nav__link">
        Linting and Testing
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../user_guide/faq/" class="md-nav__link">
        FAQ
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_3" type="checkbox" id="__nav_3" checked>
      
      
      
      
        <label class="md-nav__link" for="__nav_3">
          API Reference
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="API Reference" data-md-level="1">
        <label class="md-nav__title" for="__nav_3">
          <span class="md-nav__icon md-icon"></span>
          API Reference
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_3_1" type="checkbox" id="__nav_3_1" checked>
      
      
      
      
        
        
        <div class="md-nav__link md-nav__link--index ">
          <a href="../">channel</a>
          
            <label for="__nav_3_1">
              <span class="md-nav__icon md-icon"></span>
            </label>
          
        </div>
      
      <nav class="md-nav" aria-label="channel" data-md-level="2">
        <label class="md-nav__title" for="__nav_3_1">
          <span class="md-nav__icon md-icon"></span>
          channel
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" data-md-toggle="toc" type="checkbox" id="__toc">
      
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          async_channel
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        async_channel
      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#channel.async_channel" class="md-nav__link">
    channel.async_channel
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#channel.async_channel.AsyncChannel" class="md-nav__link">
    AsyncChannel
  </a>
  
    <nav class="md-nav" aria-label="AsyncChannel">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#channel.async_channel.AsyncChannel.channel_authenticate_ssh" class="md-nav__link">
    channel_authenticate_ssh()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#channel.async_channel.AsyncChannel.channel_authenticate_telnet" class="md-nav__link">
    channel_authenticate_telnet()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#channel.async_channel.AsyncChannel.get_prompt" class="md-nav__link">
    get_prompt()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#channel.async_channel.AsyncChannel.read" class="md-nav__link">
    read()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#channel.async_channel.AsyncChannel.send_input" class="md-nav__link">
    send_input()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#channel.async_channel.AsyncChannel.send_input_and_read" class="md-nav__link">
    send_input_and_read()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#channel.async_channel.AsyncChannel.send_inputs_interact" class="md-nav__link">
    send_inputs_interact()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../base_channel/" class="md-nav__link">
        base_channel
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../sync_channel/" class="md-nav__link">
        sync_channel
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../decorators/" class="md-nav__link">
        decorators
      </a>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_3_3" type="checkbox" id="__nav_3_3" >
      
      
      
      
        
        
        <div class="md-nav__link md-nav__link--index ">
          <a href="../../driver/">driver</a>
          
            <label for="__nav_3_3">
              <span class="md-nav__icon md-icon"></span>
            </label>
          
        </div>
      
      <nav class="md-nav" aria-label="driver" data-md-level="2">
        <label class="md-nav__title" for="__nav_3_3">
          <span class="md-nav__icon md-icon"></span>
          driver
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_3_3_1" type="checkbox" id="__nav_3_3_1" >
      
      
      
      
        
        
        <div class="md-nav__link md-nav__link--index ">
          <a href="../../driver/base/">base</a>
          
            <label for="__nav_3_3_1">
              <span class="md-nav__icon md-icon"></span>
            </label>
          
        </div>
      
      <nav class="md-nav" aria-label="base" data-md-level="3">
        <label class="md-nav__title" for="__nav_3_3_1">
          <span class="md-nav__icon md-icon"></span>
          base
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../driver/base/async_driver/" class="md-nav__link">
        async_driver
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../driver/base/base_driver/" class="md-nav__link">
        base_driver
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../driver/base/sync_driver/" class="md-nav__link">
        sync_driver
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_3_3_2" type="checkbox" id="__nav_3_3_2" >
      
      
      
      
        
        
        <div class="md-nav__link md-nav__link--index ">
          <a href="../../driver/core/">core</a>
          
            <label for="__nav_3_3_2">
              <span class="md-nav__icon md-icon"></span>
            </label>
          
        </div>
      
      <nav class="md-nav" aria-label="core" data-md-level="3">
        <label class="md-nav__title" for="__nav_3_3_2">
          <span class="md-nav__icon md-icon"></span>
          core
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_3_3_2_1" type="checkbox" id="__nav_3_3_2_1" >
      
      
      
      
        
        
        <div class="md-nav__link md-nav__link--index ">
          <a href="../../driver/core/arista_eos/">arista_eos</a>
          
            <label for="__nav_3_3_2_1">
              <span class="md-nav__icon md-icon"></span>
            </label>
          
        </div>
      
      <nav class="md-nav" aria-label="arista_eos" data-md-level="4">
        <label class="md-nav__title" for="__nav_3_3_2_1">
          <span class="md-nav__icon md-icon"></span>
          arista_eos
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../driver/core/arista_eos/async_driver/" class="md-nav__link">
        async_driver
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../driver/core/arista_eos/base_driver/" class="md-nav__link">
        base_driver
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../driver/core/arista_eos/sync_driver/" class="md-nav__link">
        sync_driver
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_3_3_2_2" type="checkbox" id="__nav_3_3_2_2" >
      
      
      
      
        
        
        <div class="md-nav__link md-nav__link--index ">
          <a href="../../driver/core/cisco_iosxe/">cisco_iosxe</a>
          
            <label for="__nav_3_3_2_2">
              <span class="md-nav__icon md-icon"></span>
            </label>
          
        </div>
      
      <nav class="md-nav" aria-label="cisco_iosxe" data-md-level="4">
        <label class="md-nav__title" for="__nav_3_3_2_2">
          <span class="md-nav__icon md-icon"></span>
          cisco_iosxe
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../driver/core/cisco_iosxe/async_driver/" class="md-nav__link">
        async_driver
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../driver/core/cisco_iosxe/base_driver/" class="md-nav__link">
        base_driver
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../driver/core/cisco_iosxe/sync_driver/" class="md-nav__link">
        sync_driver
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_3_3_2_3" type="checkbox" id="__nav_3_3_2_3" >
      
      
      
      
        
        
        <div class="md-nav__link md-nav__link--index ">
          <a href="../../driver/core/cisco_iosxr/">cisco_iosxr</a>
          
            <label for="__nav_3_3_2_3">
              <span class="md-nav__icon md-icon"></span>
            </label>
          
        </div>
      
      <nav class="md-nav" aria-label="cisco_iosxr" data-md-level="4">
        <label class="md-nav__title" for="__nav_3_3_2_3">
          <span class="md-nav__icon md-icon"></span>
          cisco_iosxr
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../driver/core/cisco_iosxr/async_driver/" class="md-nav__link">
        async_driver
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../driver/core/cisco_iosxr/base_driver/" class="md-nav__link">
        base_driver
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../driver/core/cisco_iosxr/sync_driver/" class="md-nav__link">
        sync_driver
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_3_3_2_4" type="checkbox" id="__nav_3_3_2_4" >
      
      
      
      
        
        
        <div class="md-nav__link md-nav__link--index ">
          <a href="../../driver/core/cisco_nxos/">cisco_nxos</a>
          
            <label for="__nav_3_3_2_4">
              <span class="md-nav__icon md-icon"></span>
            </label>
          
        </div>
      
      <nav class="md-nav" aria-label="cisco_nxos" data-md-level="4">
        <label class="md-nav__title" for="__nav_3_3_2_4">
          <span class="md-nav__icon md-icon"></span>
          cisco_nxos
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../driver/core/cisco_nxos/async_driver/" class="md-nav__link">
        async_driver
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../driver/core/cisco_nxos/base_driver/" class="md-nav__link">
        base_driver
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../driver/core/cisco_nxos/sync_driver/" class="md-nav__link">
        sync_driver
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_3_3_2_5" type="checkbox" id="__nav_3_3_2_5" >
      
      
      
      
        
        
        <div class="md-nav__link md-nav__link--index ">
          <a href="../../driver/core/juniper_junos/">juniper_junos</a>
          
            <label for="__nav_3_3_2_5">
              <span class="md-nav__icon md-icon"></span>
            </label>
          
        </div>
      
      <nav class="md-nav" aria-label="juniper_junos" data-md-level="4">
        <label class="md-nav__title" for="__nav_3_3_2_5">
          <span class="md-nav__icon md-icon"></span>
          juniper_junos
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../driver/core/juniper_junos/async_driver/" class="md-nav__link">
        async_driver
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../driver/core/juniper_junos/base_driver/" class="md-nav__link">
        base_driver
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../driver/core/juniper_junos/sync_driver/" class="md-nav__link">
        sync_driver
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_3_3_3" type="checkbox" id="__nav_3_3_3" >
      
      
      
      
        
        
        <div class="md-nav__link md-nav__link--index ">
          <a href="../../driver/generic/">generic</a>
          
            <label for="__nav_3_3_3">
              <span class="md-nav__icon md-icon"></span>
            </label>
          
        </div>
      
      <nav class="md-nav" aria-label="generic" data-md-level="3">
        <label class="md-nav__title" for="__nav_3_3_3">
          <span class="md-nav__icon md-icon"></span>
          generic
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../driver/generic/async_driver/" class="md-nav__link">
        async_driver
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../driver/generic/base_driver/" class="md-nav__link">
        base_driver
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../driver/generic/sync_driver/" class="md-nav__link">
        sync_driver
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_3_3_4" type="checkbox" id="__nav_3_3_4" >
      
      
      
      
        
        
        <div class="md-nav__link md-nav__link--index ">
          <a href="../../driver/network/">network</a>
          
            <label for="__nav_3_3_4">
              <span class="md-nav__icon md-icon"></span>
            </label>
          
        </div>
      
      <nav class="md-nav" aria-label="network" data-md-level="3">
        <label class="md-nav__title" for="__nav_3_3_4">
          <span class="md-nav__icon md-icon"></span>
          network
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../driver/network/async_driver/" class="md-nav__link">
        async_driver
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../driver/network/base_driver/" class="md-nav__link">
        base_driver
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../driver/network/sync_driver/" class="md-nav__link">
        sync_driver
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../exceptions/" class="md-nav__link">
        exceptions
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../factory/" class="md-nav__link">
        factory
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../helper/" class="md-nav__link">
        helper
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../logging/" class="md-nav__link">
        logging
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../response/" class="md-nav__link">
        response
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../settings/" class="md-nav__link">
        settings
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../ssh_config/" class="md-nav__link">
        ssh_config
      </a>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_3_11" type="checkbox" id="__nav_3_11" >
      
      
      
      
        
        
        <div class="md-nav__link md-nav__link--index ">
          <a href="../../transport/">transport</a>
          
            <label for="__nav_3_11">
              <span class="md-nav__icon md-icon"></span>
            </label>
          
        </div>
      
      <nav class="md-nav" aria-label="transport" data-md-level="2">
        <label class="md-nav__title" for="__nav_3_11">
          <span class="md-nav__icon md-icon"></span>
          transport
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_3_11_1" type="checkbox" id="__nav_3_11_1" >
      
      
      
      
        
        
        <div class="md-nav__link md-nav__link--index ">
          <a href="../../transport/base/">base</a>
          
            <label for="__nav_3_11_1">
              <span class="md-nav__icon md-icon"></span>
            </label>
          
        </div>
      
      <nav class="md-nav" aria-label="base" data-md-level="3">
        <label class="md-nav__title" for="__nav_3_11_1">
          <span class="md-nav__icon md-icon"></span>
          base
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../transport/base/async_transport/" class="md-nav__link">
        async_transport
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../transport/base/base_socket/" class="md-nav__link">
        base_socket
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../transport/base/base_transport/" class="md-nav__link">
        base_transport
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../transport/base/sync_transport/" class="md-nav__link">
        sync_transport
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../transport/base/telnet_common/" class="md-nav__link">
        telnet_common
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_3_11_2" type="checkbox" id="__nav_3_11_2" >
      
      
      
      
        
        
        <div class="md-nav__link md-nav__link--index ">
          <a href="../../transport/plugins/">plugins</a>
          
            <label for="__nav_3_11_2">
              <span class="md-nav__icon md-icon"></span>
            </label>
          
        </div>
      
      <nav class="md-nav" aria-label="plugins" data-md-level="3">
        <label class="md-nav__title" for="__nav_3_11_2">
          <span class="md-nav__icon md-icon"></span>
          plugins
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_3_11_2_1" type="checkbox" id="__nav_3_11_2_1" >
      
      
      
      
        
        
        <div class="md-nav__link md-nav__link--index ">
          <a href="../../transport/plugins/asyncssh/">asyncssh</a>
          
            <label for="__nav_3_11_2_1">
              <span class="md-nav__icon md-icon"></span>
            </label>
          
        </div>
      
      <nav class="md-nav" aria-label="asyncssh" data-md-level="4">
        <label class="md-nav__title" for="__nav_3_11_2_1">
          <span class="md-nav__icon md-icon"></span>
          asyncssh
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../transport/plugins/asyncssh/transport/" class="md-nav__link">
        transport
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_3_11_2_2" type="checkbox" id="__nav_3_11_2_2" >
      
      
      
      
        
        
        <div class="md-nav__link md-nav__link--index ">
          <a href="../../transport/plugins/asynctelnet/">asynctelnet</a>
          
            <label for="__nav_3_11_2_2">
              <span class="md-nav__icon md-icon"></span>
            </label>
          
        </div>
      
      <nav class="md-nav" aria-label="asynctelnet" data-md-level="4">
        <label class="md-nav__title" for="__nav_3_11_2_2">
          <span class="md-nav__icon md-icon"></span>
          asynctelnet
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../transport/plugins/asynctelnet/transport/" class="md-nav__link">
        transport
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_3_11_2_3" type="checkbox" id="__nav_3_11_2_3" >
      
      
      
      
        
        
        <div class="md-nav__link md-nav__link--index ">
          <a href="../../transport/plugins/paramiko/">paramiko</a>
          
            <label for="__nav_3_11_2_3">
              <span class="md-nav__icon md-icon"></span>
            </label>
          
        </div>
      
      <nav class="md-nav" aria-label="paramiko" data-md-level="4">
        <label class="md-nav__title" for="__nav_3_11_2_3">
          <span class="md-nav__icon md-icon"></span>
          paramiko
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../transport/plugins/paramiko/transport/" class="md-nav__link">
        transport
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_3_11_2_4" type="checkbox" id="__nav_3_11_2_4" >
      
      
      
      
        
        
        <div class="md-nav__link md-nav__link--index ">
          <a href="../../transport/plugins/ssh2/">ssh2</a>
          
            <label for="__nav_3_11_2_4">
              <span class="md-nav__icon md-icon"></span>
            </label>
          
        </div>
      
      <nav class="md-nav" aria-label="ssh2" data-md-level="4">
        <label class="md-nav__title" for="__nav_3_11_2_4">
          <span class="md-nav__icon md-icon"></span>
          ssh2
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../transport/plugins/ssh2/transport/" class="md-nav__link">
        transport
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_3_11_2_5" type="checkbox" id="__nav_3_11_2_5" >
      
      
      
      
        
        
        <div class="md-nav__link md-nav__link--index ">
          <a href="../../transport/plugins/system/">system</a>
          
            <label for="__nav_3_11_2_5">
              <span class="md-nav__icon md-icon"></span>
            </label>
          
        </div>
      
      <nav class="md-nav" aria-label="system" data-md-level="4">
        <label class="md-nav__title" for="__nav_3_11_2_5">
          <span class="md-nav__icon md-icon"></span>
          system
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../transport/plugins/system/ptyprocess/" class="md-nav__link">
        ptyprocess
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../transport/plugins/system/transport/" class="md-nav__link">
        transport
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_3_11_2_6" type="checkbox" id="__nav_3_11_2_6" >
      
      
      
      
        
        
        <div class="md-nav__link md-nav__link--index ">
          <a href="../../transport/plugins/telnet/">telnet</a>
          
            <label for="__nav_3_11_2_6">
              <span class="md-nav__icon md-icon"></span>
            </label>
          
        </div>
      
      <nav class="md-nav" aria-label="telnet" data-md-level="4">
        <label class="md-nav__title" for="__nav_3_11_2_6">
          <span class="md-nav__icon md-icon"></span>
          telnet
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../transport/plugins/telnet/transport/" class="md-nav__link">
        transport
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../../changelog/" class="md-nav__link">
        Changelog
      </a>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_5" type="checkbox" id="__nav_5" >
      
      
      
      
        <label class="md-nav__link" for="__nav_5">
          More Scrapli
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="More Scrapli" data-md-level="1">
        <label class="md-nav__title" for="__nav_5">
          <span class="md-nav__icon md-icon"></span>
          More Scrapli
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../more_scrapli/scrapli_netconf/" class="md-nav__link">
        Scrapli Netconf
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../more_scrapli/scrapli_community/" class="md-nav__link">
        Scrapli Community
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../more_scrapli/scrapli_cfg/" class="md-nav__link">
        Scrapli Cfg
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../more_scrapli/scrapli_replay/" class="md-nav__link">
        Scrapli Replay
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../more_scrapli/nornir_scrapli/" class="md-nav__link">
        Nornir Scrapli
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_6" type="checkbox" id="__nav_6" >
      
      
      
      
        <label class="md-nav__link" for="__nav_6">
          Other
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Other" data-md-level="1">
        <label class="md-nav__title" for="__nav_6">
          <span class="md-nav__icon md-icon"></span>
          Other
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../about/contributing/" class="md-nav__link">
        Contributing
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../about/code_of_conduct/" class="md-nav__link">
        Code of Conduct
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../about/thank_you/" class="md-nav__link">
        Thank Yous
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#channel.async_channel" class="md-nav__link">
    channel.async_channel
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#channel.async_channel.AsyncChannel" class="md-nav__link">
    AsyncChannel
  </a>
  
    <nav class="md-nav" aria-label="AsyncChannel">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#channel.async_channel.AsyncChannel.channel_authenticate_ssh" class="md-nav__link">
    channel_authenticate_ssh()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#channel.async_channel.AsyncChannel.channel_authenticate_telnet" class="md-nav__link">
    channel_authenticate_telnet()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#channel.async_channel.AsyncChannel.get_prompt" class="md-nav__link">
    get_prompt()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#channel.async_channel.AsyncChannel.read" class="md-nav__link">
    read()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#channel.async_channel.AsyncChannel.send_input" class="md-nav__link">
    send_input()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#channel.async_channel.AsyncChannel.send_input_and_read" class="md-nav__link">
    send_input_and_read()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#channel.async_channel.AsyncChannel.send_inputs_interact" class="md-nav__link">
    send_inputs_interact()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


  <h1>async_channel</h1>

<div class="doc doc-object doc-module">


<a id="channel.async_channel"></a>
  <div class="doc doc-contents first">
  
      <p>scrapli.channel.async_channel</p>

  

  <div class="doc doc-children">








<div class="doc doc-object doc-class">



<h2 id="channel.async_channel.AsyncChannel" class="doc doc-heading">
        <code>AsyncChannel</code>


<a href="#channel.async_channel.AsyncChannel" class="headerlink" title="Permanent link">&para;</a></h2>


  <div class="doc doc-contents ">
      <p class="doc doc-class-bases">
        Bases: <code><span title="scrapli.channel.base_channel.BaseChannel">BaseChannel</span></code></p>



        <details class="quote">
          <summary>Source code in <code>channel/async_channel.py</code></summary>
          <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 16</span>
<span class="normal"> 17</span>
<span class="normal"> 18</span>
<span class="normal"> 19</span>
<span class="normal"> 20</span>
<span class="normal"> 21</span>
<span class="normal"> 22</span>
<span class="normal"> 23</span>
<span class="normal"> 24</span>
<span class="normal"> 25</span>
<span class="normal"> 26</span>
<span class="normal"> 27</span>
<span class="normal"> 28</span>
<span class="normal"> 29</span>
<span class="normal"> 30</span>
<span class="normal"> 31</span>
<span class="normal"> 32</span>
<span class="normal"> 33</span>
<span class="normal"> 34</span>
<span class="normal"> 35</span>
<span class="normal"> 36</span>
<span class="normal"> 37</span>
<span class="normal"> 38</span>
<span class="normal"> 39</span>
<span class="normal"> 40</span>
<span class="normal"> 41</span>
<span class="normal"> 42</span>
<span class="normal"> 43</span>
<span class="normal"> 44</span>
<span class="normal"> 45</span>
<span class="normal"> 46</span>
<span class="normal"> 47</span>
<span class="normal"> 48</span>
<span class="normal"> 49</span>
<span class="normal"> 50</span>
<span class="normal"> 51</span>
<span class="normal"> 52</span>
<span class="normal"> 53</span>
<span class="normal"> 54</span>
<span class="normal"> 55</span>
<span class="normal"> 56</span>
<span class="normal"> 57</span>
<span class="normal"> 58</span>
<span class="normal"> 59</span>
<span class="normal"> 60</span>
<span class="normal"> 61</span>
<span class="normal"> 62</span>
<span class="normal"> 63</span>
<span class="normal"> 64</span>
<span class="normal"> 65</span>
<span class="normal"> 66</span>
<span class="normal"> 67</span>
<span class="normal"> 68</span>
<span class="normal"> 69</span>
<span class="normal"> 70</span>
<span class="normal"> 71</span>
<span class="normal"> 72</span>
<span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span>
<span class="normal">231</span>
<span class="normal">232</span>
<span class="normal">233</span>
<span class="normal">234</span>
<span class="normal">235</span>
<span class="normal">236</span>
<span class="normal">237</span>
<span class="normal">238</span>
<span class="normal">239</span>
<span class="normal">240</span>
<span class="normal">241</span>
<span class="normal">242</span>
<span class="normal">243</span>
<span class="normal">244</span>
<span class="normal">245</span>
<span class="normal">246</span>
<span class="normal">247</span>
<span class="normal">248</span>
<span class="normal">249</span>
<span class="normal">250</span>
<span class="normal">251</span>
<span class="normal">252</span>
<span class="normal">253</span>
<span class="normal">254</span>
<span class="normal">255</span>
<span class="normal">256</span>
<span class="normal">257</span>
<span class="normal">258</span>
<span class="normal">259</span>
<span class="normal">260</span>
<span class="normal">261</span>
<span class="normal">262</span>
<span class="normal">263</span>
<span class="normal">264</span>
<span class="normal">265</span>
<span class="normal">266</span>
<span class="normal">267</span>
<span class="normal">268</span>
<span class="normal">269</span>
<span class="normal">270</span>
<span class="normal">271</span>
<span class="normal">272</span>
<span class="normal">273</span>
<span class="normal">274</span>
<span class="normal">275</span>
<span class="normal">276</span>
<span class="normal">277</span>
<span class="normal">278</span>
<span class="normal">279</span>
<span class="normal">280</span>
<span class="normal">281</span>
<span class="normal">282</span>
<span class="normal">283</span>
<span class="normal">284</span>
<span class="normal">285</span>
<span class="normal">286</span>
<span class="normal">287</span>
<span class="normal">288</span>
<span class="normal">289</span>
<span class="normal">290</span>
<span class="normal">291</span>
<span class="normal">292</span>
<span class="normal">293</span>
<span class="normal">294</span>
<span class="normal">295</span>
<span class="normal">296</span>
<span class="normal">297</span>
<span class="normal">298</span>
<span class="normal">299</span>
<span class="normal">300</span>
<span class="normal">301</span>
<span class="normal">302</span>
<span class="normal">303</span>
<span class="normal">304</span>
<span class="normal">305</span>
<span class="normal">306</span>
<span class="normal">307</span>
<span class="normal">308</span>
<span class="normal">309</span>
<span class="normal">310</span>
<span class="normal">311</span>
<span class="normal">312</span>
<span class="normal">313</span>
<span class="normal">314</span>
<span class="normal">315</span>
<span class="normal">316</span>
<span class="normal">317</span>
<span class="normal">318</span>
<span class="normal">319</span>
<span class="normal">320</span>
<span class="normal">321</span>
<span class="normal">322</span>
<span class="normal">323</span>
<span class="normal">324</span>
<span class="normal">325</span>
<span class="normal">326</span>
<span class="normal">327</span>
<span class="normal">328</span>
<span class="normal">329</span>
<span class="normal">330</span>
<span class="normal">331</span>
<span class="normal">332</span>
<span class="normal">333</span>
<span class="normal">334</span>
<span class="normal">335</span>
<span class="normal">336</span>
<span class="normal">337</span>
<span class="normal">338</span>
<span class="normal">339</span>
<span class="normal">340</span>
<span class="normal">341</span>
<span class="normal">342</span>
<span class="normal">343</span>
<span class="normal">344</span>
<span class="normal">345</span>
<span class="normal">346</span>
<span class="normal">347</span>
<span class="normal">348</span>
<span class="normal">349</span>
<span class="normal">350</span>
<span class="normal">351</span>
<span class="normal">352</span>
<span class="normal">353</span>
<span class="normal">354</span>
<span class="normal">355</span>
<span class="normal">356</span>
<span class="normal">357</span>
<span class="normal">358</span>
<span class="normal">359</span>
<span class="normal">360</span>
<span class="normal">361</span>
<span class="normal">362</span>
<span class="normal">363</span>
<span class="normal">364</span>
<span class="normal">365</span>
<span class="normal">366</span>
<span class="normal">367</span>
<span class="normal">368</span>
<span class="normal">369</span>
<span class="normal">370</span>
<span class="normal">371</span>
<span class="normal">372</span>
<span class="normal">373</span>
<span class="normal">374</span>
<span class="normal">375</span>
<span class="normal">376</span>
<span class="normal">377</span>
<span class="normal">378</span>
<span class="normal">379</span>
<span class="normal">380</span>
<span class="normal">381</span>
<span class="normal">382</span>
<span class="normal">383</span>
<span class="normal">384</span>
<span class="normal">385</span>
<span class="normal">386</span>
<span class="normal">387</span>
<span class="normal">388</span>
<span class="normal">389</span>
<span class="normal">390</span>
<span class="normal">391</span>
<span class="normal">392</span>
<span class="normal">393</span>
<span class="normal">394</span>
<span class="normal">395</span>
<span class="normal">396</span>
<span class="normal">397</span>
<span class="normal">398</span>
<span class="normal">399</span>
<span class="normal">400</span>
<span class="normal">401</span>
<span class="normal">402</span>
<span class="normal">403</span>
<span class="normal">404</span>
<span class="normal">405</span>
<span class="normal">406</span>
<span class="normal">407</span>
<span class="normal">408</span>
<span class="normal">409</span>
<span class="normal">410</span>
<span class="normal">411</span>
<span class="normal">412</span>
<span class="normal">413</span>
<span class="normal">414</span>
<span class="normal">415</span>
<span class="normal">416</span>
<span class="normal">417</span>
<span class="normal">418</span>
<span class="normal">419</span>
<span class="normal">420</span>
<span class="normal">421</span>
<span class="normal">422</span>
<span class="normal">423</span>
<span class="normal">424</span>
<span class="normal">425</span>
<span class="normal">426</span>
<span class="normal">427</span>
<span class="normal">428</span>
<span class="normal">429</span>
<span class="normal">430</span>
<span class="normal">431</span>
<span class="normal">432</span>
<span class="normal">433</span>
<span class="normal">434</span>
<span class="normal">435</span>
<span class="normal">436</span>
<span class="normal">437</span>
<span class="normal">438</span>
<span class="normal">439</span>
<span class="normal">440</span>
<span class="normal">441</span>
<span class="normal">442</span>
<span class="normal">443</span>
<span class="normal">444</span>
<span class="normal">445</span>
<span class="normal">446</span>
<span class="normal">447</span>
<span class="normal">448</span>
<span class="normal">449</span>
<span class="normal">450</span>
<span class="normal">451</span>
<span class="normal">452</span>
<span class="normal">453</span>
<span class="normal">454</span>
<span class="normal">455</span>
<span class="normal">456</span>
<span class="normal">457</span>
<span class="normal">458</span>
<span class="normal">459</span>
<span class="normal">460</span>
<span class="normal">461</span>
<span class="normal">462</span>
<span class="normal">463</span>
<span class="normal">464</span>
<span class="normal">465</span>
<span class="normal">466</span>
<span class="normal">467</span>
<span class="normal">468</span>
<span class="normal">469</span>
<span class="normal">470</span>
<span class="normal">471</span>
<span class="normal">472</span>
<span class="normal">473</span>
<span class="normal">474</span>
<span class="normal">475</span>
<span class="normal">476</span>
<span class="normal">477</span>
<span class="normal">478</span>
<span class="normal">479</span>
<span class="normal">480</span>
<span class="normal">481</span>
<span class="normal">482</span>
<span class="normal">483</span>
<span class="normal">484</span>
<span class="normal">485</span>
<span class="normal">486</span>
<span class="normal">487</span>
<span class="normal">488</span>
<span class="normal">489</span>
<span class="normal">490</span>
<span class="normal">491</span>
<span class="normal">492</span>
<span class="normal">493</span>
<span class="normal">494</span>
<span class="normal">495</span>
<span class="normal">496</span>
<span class="normal">497</span>
<span class="normal">498</span>
<span class="normal">499</span>
<span class="normal">500</span>
<span class="normal">501</span>
<span class="normal">502</span>
<span class="normal">503</span>
<span class="normal">504</span>
<span class="normal">505</span>
<span class="normal">506</span>
<span class="normal">507</span>
<span class="normal">508</span>
<span class="normal">509</span>
<span class="normal">510</span>
<span class="normal">511</span>
<span class="normal">512</span>
<span class="normal">513</span>
<span class="normal">514</span>
<span class="normal">515</span>
<span class="normal">516</span>
<span class="normal">517</span>
<span class="normal">518</span>
<span class="normal">519</span>
<span class="normal">520</span>
<span class="normal">521</span>
<span class="normal">522</span>
<span class="normal">523</span>
<span class="normal">524</span>
<span class="normal">525</span>
<span class="normal">526</span>
<span class="normal">527</span>
<span class="normal">528</span>
<span class="normal">529</span>
<span class="normal">530</span>
<span class="normal">531</span>
<span class="normal">532</span>
<span class="normal">533</span>
<span class="normal">534</span>
<span class="normal">535</span>
<span class="normal">536</span>
<span class="normal">537</span>
<span class="normal">538</span>
<span class="normal">539</span>
<span class="normal">540</span>
<span class="normal">541</span>
<span class="normal">542</span>
<span class="normal">543</span>
<span class="normal">544</span>
<span class="normal">545</span>
<span class="normal">546</span>
<span class="normal">547</span>
<span class="normal">548</span>
<span class="normal">549</span>
<span class="normal">550</span>
<span class="normal">551</span>
<span class="normal">552</span>
<span class="normal">553</span>
<span class="normal">554</span>
<span class="normal">555</span>
<span class="normal">556</span>
<span class="normal">557</span>
<span class="normal">558</span>
<span class="normal">559</span>
<span class="normal">560</span>
<span class="normal">561</span>
<span class="normal">562</span>
<span class="normal">563</span>
<span class="normal">564</span>
<span class="normal">565</span>
<span class="normal">566</span>
<span class="normal">567</span>
<span class="normal">568</span>
<span class="normal">569</span>
<span class="normal">570</span>
<span class="normal">571</span>
<span class="normal">572</span>
<span class="normal">573</span>
<span class="normal">574</span>
<span class="normal">575</span>
<span class="normal">576</span>
<span class="normal">577</span>
<span class="normal">578</span>
<span class="normal">579</span>
<span class="normal">580</span>
<span class="normal">581</span>
<span class="normal">582</span>
<span class="normal">583</span>
<span class="normal">584</span>
<span class="normal">585</span>
<span class="normal">586</span>
<span class="normal">587</span>
<span class="normal">588</span>
<span class="normal">589</span>
<span class="normal">590</span>
<span class="normal">591</span>
<span class="normal">592</span>
<span class="normal">593</span>
<span class="normal">594</span>
<span class="normal">595</span>
<span class="normal">596</span>
<span class="normal">597</span>
<span class="normal">598</span>
<span class="normal">599</span>
<span class="normal">600</span>
<span class="normal">601</span>
<span class="normal">602</span>
<span class="normal">603</span>
<span class="normal">604</span>
<span class="normal">605</span>
<span class="normal">606</span>
<span class="normal">607</span>
<span class="normal">608</span>
<span class="normal">609</span>
<span class="normal">610</span>
<span class="normal">611</span>
<span class="normal">612</span>
<span class="normal">613</span>
<span class="normal">614</span>
<span class="normal">615</span>
<span class="normal">616</span>
<span class="normal">617</span>
<span class="normal">618</span>
<span class="normal">619</span>
<span class="normal">620</span>
<span class="normal">621</span>
<span class="normal">622</span>
<span class="normal">623</span>
<span class="normal">624</span>
<span class="normal">625</span>
<span class="normal">626</span>
<span class="normal">627</span>
<span class="normal">628</span>
<span class="normal">629</span>
<span class="normal">630</span>
<span class="normal">631</span>
<span class="normal">632</span>
<span class="normal">633</span>
<span class="normal">634</span>
<span class="normal">635</span>
<span class="normal">636</span>
<span class="normal">637</span>
<span class="normal">638</span>
<span class="normal">639</span>
<span class="normal">640</span>
<span class="normal">641</span>
<span class="normal">642</span>
<span class="normal">643</span>
<span class="normal">644</span>
<span class="normal">645</span>
<span class="normal">646</span>
<span class="normal">647</span>
<span class="normal">648</span>
<span class="normal">649</span>
<span class="normal">650</span>
<span class="normal">651</span>
<span class="normal">652</span>
<span class="normal">653</span>
<span class="normal">654</span>
<span class="normal">655</span>
<span class="normal">656</span>
<span class="normal">657</span>
<span class="normal">658</span>
<span class="normal">659</span>
<span class="normal">660</span>
<span class="normal">661</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">AsyncChannel</span><span class="p">(</span><span class="n">BaseChannel</span><span class="p">):</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">transport</span><span class="p">:</span> <span class="n">AsyncTransport</span><span class="p">,</span>
        <span class="n">base_channel_args</span><span class="p">:</span> <span class="n">BaseChannelArgs</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span>
            <span class="n">transport</span><span class="o">=</span><span class="n">transport</span><span class="p">,</span>
            <span class="n">base_channel_args</span><span class="o">=</span><span class="n">base_channel_args</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">transport</span><span class="p">:</span> <span class="n">AsyncTransport</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">channel_lock</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">asyncio</span><span class="o">.</span><span class="n">Lock</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_base_channel_args</span><span class="o">.</span><span class="n">channel_lock</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">channel_lock</span> <span class="o">=</span> <span class="n">asyncio</span><span class="o">.</span><span class="n">Lock</span><span class="p">()</span>

    <span class="nd">@asynccontextmanager</span>
    <span class="k">async</span> <span class="k">def</span> <span class="nf">_channel_lock</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">AsyncIterator</span><span class="p">[</span><span class="kc">None</span><span class="p">]:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Lock the channel during public channel operations if channel_lock is enabled</span>

<span class="sd">        Args:</span>
<span class="sd">            N/A</span>

<span class="sd">        Yields:</span>
<span class="sd">            None</span>

<span class="sd">        Raises:</span>
<span class="sd">            N/A</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">channel_lock</span><span class="p">:</span>
            <span class="k">async</span> <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">channel_lock</span><span class="p">:</span>
                <span class="k">yield</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">yield</span>

    <span class="k">async</span> <span class="k">def</span> <span class="nf">read</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bytes</span><span class="p">:</span>
        <span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Read chunks of output from the channel</span>

<span class="sd">        Replaces any \r characters that sometimes get stuffed into the output from the devices</span>

<span class="sd">        Args:</span>
<span class="sd">            N/A</span>

<span class="sd">        Returns:</span>
<span class="sd">            bytes: output read from channel</span>

<span class="sd">        Raises:</span>
<span class="sd">            N/A</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">buf</span> <span class="o">=</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">transport</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
        <span class="n">buf</span> <span class="o">=</span> <span class="n">buf</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="sa">b</span><span class="s2">&quot;</span><span class="se">\r</span><span class="s2">&quot;</span><span class="p">,</span> <span class="sa">b</span><span class="s2">&quot;&quot;</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;read: </span><span class="si">{</span><span class="n">buf</span><span class="si">!r}</span><span class="s2">&quot;</span><span class="p">)</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">channel_log</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">channel_log</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">buf</span><span class="p">)</span>

        <span class="k">if</span> <span class="sa">b</span><span class="s2">&quot;</span><span class="se">\x1b</span><span class="s2">&quot;</span> <span class="ow">in</span> <span class="n">buf</span><span class="o">.</span><span class="n">lower</span><span class="p">():</span>
            <span class="n">buf</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_strip_ansi</span><span class="p">(</span><span class="n">buf</span><span class="o">=</span><span class="n">buf</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">buf</span>

    <span class="k">async</span> <span class="k">def</span> <span class="nf">_read_until_input</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">channel_input</span><span class="p">:</span> <span class="nb">bytes</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bytes</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Read until all channel_input has been read on the channel</span>

<span class="sd">        Args:</span>
<span class="sd">            channel_input: bytes that should have been written to the channel</span>

<span class="sd">        Returns:</span>
<span class="sd">            bytes: output read from channel while checking for the input in the channel stream</span>

<span class="sd">        Raises:</span>
<span class="sd">            N/A</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">buf</span> <span class="o">=</span> <span class="sa">b</span><span class="s2">&quot;&quot;</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">channel_input</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">buf</span>

        <span class="c1"># squish all channel input words together and cast to lower to make comparison easier</span>
        <span class="n">processed_channel_input</span> <span class="o">=</span> <span class="sa">b</span><span class="s2">&quot;&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">channel_input</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">())</span>

        <span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
            <span class="n">buf</span> <span class="o">+=</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>

            <span class="c1"># replace any backspace chars (particular problem w/ junos), and remove any added spaces</span>
            <span class="c1"># this is just for comparison of the inputs to what was read from channel</span>
            <span class="k">if</span> <span class="n">processed_channel_input</span> <span class="ow">in</span> <span class="sa">b</span><span class="s2">&quot;&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">buf</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="sa">b</span><span class="s2">&quot;</span><span class="se">\x08</span><span class="s2">&quot;</span><span class="p">,</span> <span class="sa">b</span><span class="s2">&quot;&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">split</span><span class="p">()):</span>
                <span class="k">return</span> <span class="n">buf</span>

    <span class="k">async</span> <span class="k">def</span> <span class="nf">_read_until_prompt</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">buf</span><span class="p">:</span> <span class="nb">bytes</span> <span class="o">=</span> <span class="sa">b</span><span class="s2">&quot;&quot;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bytes</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Read until expected prompt is seen.</span>

<span class="sd">        This reads until the &quot;normal&quot; `_base_channel_args.comms_prompt_pattern` is seen. The</span>
<span class="sd">        `_read_until_explicit_prompt` method can be used to read until some pattern in an arbitrary</span>
<span class="sd">        list of patterns is seen.</span>

<span class="sd">        Args:</span>
<span class="sd">            buf: output from previous reads if needed (used by scrapli netconf)</span>

<span class="sd">        Returns:</span>
<span class="sd">            bytes: output read from channel</span>

<span class="sd">        Raises:</span>
<span class="sd">            N/A</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">search_pattern</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_prompt_pattern</span><span class="p">(</span>
            <span class="n">class_pattern</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_base_channel_args</span><span class="o">.</span><span class="n">comms_prompt_pattern</span>
        <span class="p">)</span>

        <span class="n">read_buf</span> <span class="o">=</span> <span class="n">BytesIO</span><span class="p">(</span><span class="n">buf</span><span class="p">)</span>

        <span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
            <span class="n">b</span> <span class="o">=</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
            <span class="n">read_buf</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">b</span><span class="p">)</span>

            <span class="n">search_buf</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_process_read_buf</span><span class="p">(</span><span class="n">read_buf</span><span class="o">=</span><span class="n">read_buf</span><span class="p">)</span>

            <span class="n">channel_match</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">search</span><span class="p">(</span>
                <span class="n">pattern</span><span class="o">=</span><span class="n">search_pattern</span><span class="p">,</span>
                <span class="n">string</span><span class="o">=</span><span class="n">search_buf</span><span class="p">,</span>
            <span class="p">)</span>

            <span class="k">if</span> <span class="n">channel_match</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">read_buf</span><span class="o">.</span><span class="n">getvalue</span><span class="p">()</span>

    <span class="k">async</span> <span class="k">def</span> <span class="nf">_read_until_explicit_prompt</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">prompts</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="nb">bytes</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Read until expected prompt is seen.</span>

<span class="sd">        This method is for *explicit* prompt patterns instead of the &quot;standard&quot; prompt patterns</span>
<span class="sd">        contained in the `_base_channel_args.comms_prompt_pattern` attribute. Generally this is</span>
<span class="sd">        only used for `send_interactive` though it could be used elsewhere as well.</span>

<span class="sd">        Args:</span>
<span class="sd">            prompts: list of prompt patterns to look for, will return upon seeing any match</span>

<span class="sd">        Returns:</span>
<span class="sd">            bytes: output read from channel</span>

<span class="sd">        Raises:</span>
<span class="sd">            N/A</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">search_patterns</span> <span class="o">=</span> <span class="p">[</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_get_prompt_pattern</span><span class="p">(</span>
                <span class="n">class_pattern</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_base_channel_args</span><span class="o">.</span><span class="n">comms_prompt_pattern</span><span class="p">,</span> <span class="n">pattern</span><span class="o">=</span><span class="n">prompt</span>
            <span class="p">)</span>
            <span class="k">for</span> <span class="n">prompt</span> <span class="ow">in</span> <span class="n">prompts</span>
        <span class="p">]</span>

        <span class="n">read_buf</span> <span class="o">=</span> <span class="n">BytesIO</span><span class="p">(</span><span class="sa">b</span><span class="s2">&quot;&quot;</span><span class="p">)</span>

        <span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
            <span class="n">b</span> <span class="o">=</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
            <span class="n">read_buf</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">b</span><span class="p">)</span>

            <span class="n">search_buf</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_process_read_buf</span><span class="p">(</span><span class="n">read_buf</span><span class="o">=</span><span class="n">read_buf</span><span class="p">)</span>

            <span class="k">for</span> <span class="n">search_pattern</span> <span class="ow">in</span> <span class="n">search_patterns</span><span class="p">:</span>
                <span class="n">channel_match</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">search</span><span class="p">(</span>
                    <span class="n">pattern</span><span class="o">=</span><span class="n">search_pattern</span><span class="p">,</span>
                    <span class="n">string</span><span class="o">=</span><span class="n">search_buf</span><span class="p">,</span>
                <span class="p">)</span>

                <span class="k">if</span> <span class="n">channel_match</span><span class="p">:</span>
                    <span class="k">return</span> <span class="n">read_buf</span><span class="o">.</span><span class="n">getvalue</span><span class="p">()</span>

    <span class="k">async</span> <span class="k">def</span> <span class="nf">_read_until_prompt_or_time</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">buf</span><span class="p">:</span> <span class="nb">bytes</span> <span class="o">=</span> <span class="sa">b</span><span class="s2">&quot;&quot;</span><span class="p">,</span>
        <span class="n">channel_outputs</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">bytes</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">read_duration</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bytes</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Read until expected prompt is seen, outputs are seen, or for duration, whichever comes first</span>

<span class="sd">        As transport reading may block, transport timeout is temporarily set to the read_duration</span>
<span class="sd">        and any `ScrapliTimeout` that is raised while reading is ignored.</span>

<span class="sd">        Args:</span>
<span class="sd">            buf: bytes from previous reads if needed</span>
<span class="sd">            channel_outputs: List of bytes to search for in channel output, if any are seen, return</span>
<span class="sd">                read output</span>
<span class="sd">            read_duration: duration to read from channel for</span>

<span class="sd">        Returns:</span>
<span class="sd">            bytes: output read from channel</span>

<span class="sd">        Raises:</span>
<span class="sd">            N/A</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">search_pattern</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_prompt_pattern</span><span class="p">(</span>
            <span class="n">class_pattern</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_base_channel_args</span><span class="o">.</span><span class="n">comms_prompt_pattern</span><span class="p">,</span>
        <span class="p">)</span>

        <span class="k">if</span> <span class="n">channel_outputs</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">channel_outputs</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">if</span> <span class="n">read_duration</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">read_duration</span> <span class="o">=</span> <span class="mf">2.5</span>

        <span class="n">regex_channel_outputs_pattern</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_join_and_compile</span><span class="p">(</span><span class="n">channel_outputs</span><span class="o">=</span><span class="n">channel_outputs</span><span class="p">)</span>

        <span class="n">_transport_args</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">transport</span><span class="o">.</span><span class="n">_base_transport_args</span>  <span class="c1"># pylint: disable=W0212</span>
        <span class="n">previous_timeout_transport</span> <span class="o">=</span> <span class="n">_transport_args</span><span class="o">.</span><span class="n">timeout_transport</span>
        <span class="n">_transport_args</span><span class="o">.</span><span class="n">timeout_transport</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">read_duration</span><span class="p">)</span>

        <span class="n">read_buf</span> <span class="o">=</span> <span class="n">BytesIO</span><span class="p">(</span><span class="n">buf</span><span class="p">)</span>

        <span class="n">start</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
        <span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
            <span class="k">with</span> <span class="n">suppress</span><span class="p">(</span><span class="n">ScrapliTimeout</span><span class="p">):</span>
                <span class="n">b</span> <span class="o">=</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
                <span class="n">read_buf</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">b</span><span class="p">)</span>

            <span class="n">search_buf</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_process_read_buf</span><span class="p">(</span><span class="n">read_buf</span><span class="o">=</span><span class="n">read_buf</span><span class="p">)</span>

            <span class="k">if</span> <span class="p">(</span><span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span> <span class="o">-</span> <span class="n">start</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">read_duration</span><span class="p">:</span>
                <span class="k">break</span>
            <span class="k">if</span> <span class="nb">any</span><span class="p">((</span><span class="n">channel_output</span> <span class="ow">in</span> <span class="n">search_buf</span> <span class="k">for</span> <span class="n">channel_output</span> <span class="ow">in</span> <span class="n">channel_outputs</span><span class="p">)):</span>
                <span class="k">break</span>
            <span class="k">if</span> <span class="n">re</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="n">pattern</span><span class="o">=</span><span class="n">regex_channel_outputs_pattern</span><span class="p">,</span> <span class="n">string</span><span class="o">=</span><span class="n">search_buf</span><span class="p">):</span>
                <span class="k">break</span>
            <span class="k">if</span> <span class="n">re</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="n">pattern</span><span class="o">=</span><span class="n">search_pattern</span><span class="p">,</span> <span class="n">string</span><span class="o">=</span><span class="n">search_buf</span><span class="p">):</span>
                <span class="k">break</span>

        <span class="n">_transport_args</span><span class="o">.</span><span class="n">timeout_transport</span> <span class="o">=</span> <span class="n">previous_timeout_transport</span>

        <span class="k">return</span> <span class="n">read_buf</span><span class="o">.</span><span class="n">getvalue</span><span class="p">()</span>

    <span class="nd">@timeout_wrapper</span>
    <span class="k">async</span> <span class="k">def</span> <span class="nf">channel_authenticate_ssh</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">auth_password</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">auth_private_key_passphrase</span><span class="p">:</span> <span class="nb">str</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Handle SSH Authentication for transports that only operate &quot;in the channel&quot; (i.e. system)</span>

<span class="sd">        Args:</span>
<span class="sd">            auth_password: password to authenticate with</span>
<span class="sd">            auth_private_key_passphrase: passphrase for ssh key if necessary</span>

<span class="sd">        Returns:</span>
<span class="sd">            None</span>

<span class="sd">        Raises:</span>
<span class="sd">            ScrapliAuthenticationFailed: if password prompt seen more than twice</span>
<span class="sd">            ScrapliAuthenticationFailed: if passphrase prompt seen more than twice</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;attempting in channel ssh authentication&quot;</span><span class="p">)</span>

        <span class="n">password_count</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">passphrase_count</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">authenticate_buf</span> <span class="o">=</span> <span class="sa">b</span><span class="s2">&quot;&quot;</span>

        <span class="p">(</span>
            <span class="n">password_pattern</span><span class="p">,</span>
            <span class="n">passphrase_pattern</span><span class="p">,</span>
            <span class="n">prompt_pattern</span><span class="p">,</span>
        <span class="p">)</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_pre_channel_authenticate_ssh</span><span class="p">()</span>

        <span class="k">async</span> <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">_channel_lock</span><span class="p">():</span>
            <span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="n">buf</span> <span class="o">=</span> <span class="k">await</span> <span class="n">asyncio</span><span class="o">.</span><span class="n">wait_for</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">read</span><span class="p">(),</span> <span class="n">timeout</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
                <span class="k">except</span> <span class="n">asyncio</span><span class="o">.</span><span class="n">TimeoutError</span><span class="p">:</span>
                    <span class="n">buf</span> <span class="o">=</span> <span class="sa">b</span><span class="s2">&quot;&quot;</span>
                <span class="n">authenticate_buf</span> <span class="o">+=</span> <span class="n">buf</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>

                <span class="k">if</span> <span class="n">re</span><span class="o">.</span><span class="n">search</span><span class="p">(</span>
                    <span class="n">pattern</span><span class="o">=</span><span class="n">password_pattern</span><span class="p">,</span>
                    <span class="n">string</span><span class="o">=</span><span class="n">authenticate_buf</span><span class="p">,</span>
                <span class="p">):</span>
                    <span class="c1"># clear the authentication buffer so we don&#39;t re-read the password prompt</span>
                    <span class="n">authenticate_buf</span> <span class="o">=</span> <span class="sa">b</span><span class="s2">&quot;&quot;</span>
                    <span class="n">password_count</span> <span class="o">+=</span> <span class="mi">1</span>
                    <span class="k">if</span> <span class="n">password_count</span> <span class="o">&gt;</span> <span class="mi">2</span><span class="p">:</span>
                        <span class="n">msg</span> <span class="o">=</span> <span class="s2">&quot;password prompt seen more than once, assuming auth failed&quot;</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">critical</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>
                        <span class="k">raise</span> <span class="n">ScrapliAuthenticationFailed</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">channel_input</span><span class="o">=</span><span class="n">auth_password</span><span class="p">,</span> <span class="n">redacted</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">send_return</span><span class="p">()</span>

                <span class="k">if</span> <span class="n">re</span><span class="o">.</span><span class="n">search</span><span class="p">(</span>
                    <span class="n">pattern</span><span class="o">=</span><span class="n">passphrase_pattern</span><span class="p">,</span>
                    <span class="n">string</span><span class="o">=</span><span class="n">authenticate_buf</span><span class="p">,</span>
                <span class="p">):</span>
                    <span class="c1"># clear the authentication buffer so we don&#39;t re-read the passphrase prompt</span>
                    <span class="n">authenticate_buf</span> <span class="o">=</span> <span class="sa">b</span><span class="s2">&quot;&quot;</span>
                    <span class="n">passphrase_count</span> <span class="o">+=</span> <span class="mi">1</span>
                    <span class="k">if</span> <span class="n">passphrase_count</span> <span class="o">&gt;</span> <span class="mi">2</span><span class="p">:</span>
                        <span class="n">msg</span> <span class="o">=</span> <span class="s2">&quot;passphrase prompt seen more than once, assuming auth failed&quot;</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">critical</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>
                        <span class="k">raise</span> <span class="n">ScrapliAuthenticationFailed</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">channel_input</span><span class="o">=</span><span class="n">auth_private_key_passphrase</span><span class="p">,</span> <span class="n">redacted</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">send_return</span><span class="p">()</span>

                <span class="k">if</span> <span class="n">re</span><span class="o">.</span><span class="n">search</span><span class="p">(</span>
                    <span class="n">pattern</span><span class="o">=</span><span class="n">prompt_pattern</span><span class="p">,</span>
                    <span class="n">string</span><span class="o">=</span><span class="n">authenticate_buf</span><span class="p">,</span>
                <span class="p">):</span>
                    <span class="k">return</span>

    <span class="nd">@timeout_wrapper</span>
    <span class="k">async</span> <span class="k">def</span> <span class="nf">channel_authenticate_telnet</span><span class="p">(</span>  <span class="c1"># noqa: C901</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">auth_username</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">auth_password</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Handle Telnet Authentication</span>

<span class="sd">        Args:</span>
<span class="sd">            auth_username: username to use for telnet authentication</span>
<span class="sd">            auth_password: password to use for telnet authentication</span>

<span class="sd">        Returns:</span>
<span class="sd">            None</span>

<span class="sd">        Raises:</span>
<span class="sd">            ScrapliAuthenticationFailed: if password prompt seen more than twice</span>
<span class="sd">            ScrapliAuthenticationFailed: if login prompt seen more than twice</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;attempting in channel telnet authentication&quot;</span><span class="p">)</span>

        <span class="n">username_count</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">password_count</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">authenticate_buf</span> <span class="o">=</span> <span class="sa">b</span><span class="s2">&quot;&quot;</span>

        <span class="p">(</span>
            <span class="n">username_pattern</span><span class="p">,</span>
            <span class="n">password_pattern</span><span class="p">,</span>
            <span class="n">prompt_pattern</span><span class="p">,</span>
            <span class="n">auth_start_time</span><span class="p">,</span>
            <span class="n">return_interval</span><span class="p">,</span>
        <span class="p">)</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_pre_channel_authenticate_telnet</span><span class="p">()</span>

        <span class="n">read_interval</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_base_channel_args</span><span class="o">.</span><span class="n">timeout_ops</span> <span class="o">/</span> <span class="mi">20</span>
        <span class="n">return_attempts</span> <span class="o">=</span> <span class="mi">1</span>

        <span class="k">async</span> <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">_channel_lock</span><span class="p">():</span>
            <span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="n">buf</span> <span class="o">=</span> <span class="k">await</span> <span class="n">asyncio</span><span class="o">.</span><span class="n">wait_for</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">read</span><span class="p">(),</span> <span class="n">timeout</span><span class="o">=</span><span class="n">read_interval</span><span class="p">)</span>
                <span class="k">except</span> <span class="n">asyncio</span><span class="o">.</span><span class="n">TimeoutError</span><span class="p">:</span>
                    <span class="n">buf</span> <span class="o">=</span> <span class="sa">b</span><span class="s2">&quot;&quot;</span>

                <span class="k">if</span> <span class="ow">not</span> <span class="n">buf</span><span class="p">:</span>
                    <span class="n">current_iteration_time</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span><span class="o">.</span><span class="n">timestamp</span><span class="p">()</span>
                    <span class="k">if</span> <span class="p">(</span><span class="n">current_iteration_time</span> <span class="o">-</span> <span class="n">auth_start_time</span><span class="p">)</span> <span class="o">&gt;</span> <span class="p">(</span>
                        <span class="n">return_interval</span> <span class="o">*</span> <span class="n">return_attempts</span>
                    <span class="p">):</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">send_return</span><span class="p">()</span>
                        <span class="n">return_attempts</span> <span class="o">+=</span> <span class="mi">1</span>

                <span class="n">authenticate_buf</span> <span class="o">+=</span> <span class="n">buf</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>

                <span class="k">if</span> <span class="n">re</span><span class="o">.</span><span class="n">search</span><span class="p">(</span>
                    <span class="n">pattern</span><span class="o">=</span><span class="n">username_pattern</span><span class="p">,</span>
                    <span class="n">string</span><span class="o">=</span><span class="n">authenticate_buf</span><span class="p">,</span>
                <span class="p">):</span>
                    <span class="c1"># clear the authentication buffer so we don&#39;t re-read the username prompt</span>
                    <span class="n">authenticate_buf</span> <span class="o">=</span> <span class="sa">b</span><span class="s2">&quot;&quot;</span>
                    <span class="n">username_count</span> <span class="o">+=</span> <span class="mi">1</span>
                    <span class="k">if</span> <span class="n">username_count</span> <span class="o">&gt;</span> <span class="mi">2</span><span class="p">:</span>
                        <span class="n">msg</span> <span class="o">=</span> <span class="s2">&quot;username/login prompt seen more than once, assuming auth failed&quot;</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">critical</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>
                        <span class="k">raise</span> <span class="n">ScrapliAuthenticationFailed</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">channel_input</span><span class="o">=</span><span class="n">auth_username</span><span class="p">)</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">send_return</span><span class="p">()</span>

                <span class="k">if</span> <span class="n">re</span><span class="o">.</span><span class="n">search</span><span class="p">(</span>
                    <span class="n">pattern</span><span class="o">=</span><span class="n">password_pattern</span><span class="p">,</span>
                    <span class="n">string</span><span class="o">=</span><span class="n">authenticate_buf</span><span class="p">,</span>
                <span class="p">):</span>
                    <span class="c1"># clear the authentication buffer so we don&#39;t re-read the password prompt</span>
                    <span class="n">authenticate_buf</span> <span class="o">=</span> <span class="sa">b</span><span class="s2">&quot;&quot;</span>
                    <span class="n">password_count</span> <span class="o">+=</span> <span class="mi">1</span>
                    <span class="k">if</span> <span class="n">password_count</span> <span class="o">&gt;</span> <span class="mi">2</span><span class="p">:</span>
                        <span class="n">msg</span> <span class="o">=</span> <span class="s2">&quot;password prompt seen more than once, assuming auth failed&quot;</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">critical</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>
                        <span class="k">raise</span> <span class="n">ScrapliAuthenticationFailed</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">channel_input</span><span class="o">=</span><span class="n">auth_password</span><span class="p">,</span> <span class="n">redacted</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">send_return</span><span class="p">()</span>

                <span class="k">if</span> <span class="n">re</span><span class="o">.</span><span class="n">search</span><span class="p">(</span>
                    <span class="n">pattern</span><span class="o">=</span><span class="n">prompt_pattern</span><span class="p">,</span>
                    <span class="n">string</span><span class="o">=</span><span class="n">authenticate_buf</span><span class="p">,</span>
                <span class="p">):</span>
                    <span class="k">return</span>

    <span class="nd">@timeout_wrapper</span>
    <span class="k">async</span> <span class="k">def</span> <span class="nf">get_prompt</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Get current channel prompt</span>

<span class="sd">        Args:</span>
<span class="sd">            N/A</span>

<span class="sd">        Returns:</span>
<span class="sd">            str: string of the current prompt</span>

<span class="sd">        Raises:</span>
<span class="sd">            N/A</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">buf</span> <span class="o">=</span> <span class="sa">b</span><span class="s2">&quot;&quot;</span>

        <span class="n">search_pattern</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_prompt_pattern</span><span class="p">(</span>
            <span class="n">class_pattern</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_base_channel_args</span><span class="o">.</span><span class="n">comms_prompt_pattern</span>
        <span class="p">)</span>

        <span class="k">async</span> <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">_channel_lock</span><span class="p">():</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">send_return</span><span class="p">()</span>

            <span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
                <span class="n">buf</span> <span class="o">+=</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>

                <span class="n">channel_match</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">search</span><span class="p">(</span>
                    <span class="n">pattern</span><span class="o">=</span><span class="n">search_pattern</span><span class="p">,</span>
                    <span class="n">string</span><span class="o">=</span><span class="n">buf</span><span class="p">,</span>
                <span class="p">)</span>

                <span class="k">if</span> <span class="n">channel_match</span><span class="p">:</span>
                    <span class="n">current_prompt</span> <span class="o">=</span> <span class="n">channel_match</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
                    <span class="k">return</span> <span class="n">current_prompt</span><span class="o">.</span><span class="n">decode</span><span class="p">()</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>

    <span class="nd">@timeout_wrapper</span>
    <span class="k">async</span> <span class="k">def</span> <span class="nf">send_input</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">channel_input</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="o">*</span><span class="p">,</span>
        <span class="n">strip_prompt</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
        <span class="n">eager</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="nb">bytes</span><span class="p">,</span> <span class="nb">bytes</span><span class="p">]:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Primary entry point to send data to devices in shell mode; accept input and returns result</span>

<span class="sd">        Args:</span>
<span class="sd">            channel_input: string input to send to channel</span>
<span class="sd">            strip_prompt: strip prompt or not, defaults to True (yes, strip the prompt)</span>
<span class="sd">            eager: eager mode reads and returns the `_read_until_input` value, but does not attempt</span>
<span class="sd">                to read to the prompt pattern -- this should not be used manually! (only used by</span>
<span class="sd">                `send_configs` with the eager flag set)</span>

<span class="sd">        Returns:</span>
<span class="sd">            Tuple[bytes, bytes]: tuple of &quot;raw&quot; output and &quot;processed&quot; (cleaned up/stripped) output</span>

<span class="sd">        Raises:</span>
<span class="sd">            N/A</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_pre_send_input</span><span class="p">(</span><span class="n">channel_input</span><span class="o">=</span><span class="n">channel_input</span><span class="p">)</span>

        <span class="n">buf</span> <span class="o">=</span> <span class="sa">b</span><span class="s2">&quot;&quot;</span>
        <span class="n">bytes_channel_input</span> <span class="o">=</span> <span class="n">channel_input</span><span class="o">.</span><span class="n">encode</span><span class="p">()</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;sending channel input: </span><span class="si">{</span><span class="n">channel_input</span><span class="si">}</span><span class="s2">; strip_prompt: </span><span class="si">{</span><span class="n">strip_prompt</span><span class="si">}</span><span class="s2">; eager: </span><span class="si">{</span><span class="n">eager</span><span class="si">}</span><span class="s2">&quot;</span>
        <span class="p">)</span>

        <span class="k">async</span> <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">_channel_lock</span><span class="p">():</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">channel_input</span><span class="o">=</span><span class="n">channel_input</span><span class="p">)</span>
            <span class="n">_buf_until_input</span> <span class="o">=</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_read_until_input</span><span class="p">(</span><span class="n">channel_input</span><span class="o">=</span><span class="n">bytes_channel_input</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">send_return</span><span class="p">()</span>

            <span class="k">if</span> <span class="ow">not</span> <span class="n">eager</span><span class="p">:</span>
                <span class="n">buf</span> <span class="o">+=</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_read_until_prompt</span><span class="p">()</span>

        <span class="n">processed_buf</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_process_output</span><span class="p">(</span>
            <span class="n">buf</span><span class="o">=</span><span class="n">buf</span><span class="p">,</span>
            <span class="n">strip_prompt</span><span class="o">=</span><span class="n">strip_prompt</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="k">return</span> <span class="n">buf</span><span class="p">,</span> <span class="n">processed_buf</span>

    <span class="nd">@timeout_wrapper</span>
    <span class="k">async</span> <span class="k">def</span> <span class="nf">send_input_and_read</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">channel_input</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="o">*</span><span class="p">,</span>
        <span class="n">strip_prompt</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
        <span class="n">expected_outputs</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">read_duration</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="nb">bytes</span><span class="p">,</span> <span class="nb">bytes</span><span class="p">]:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Send a command and read until expected prompt is seen, outputs are seen, or for duration</span>

<span class="sd">        Args:</span>
<span class="sd">            channel_input: string input to send to channel</span>
<span class="sd">            strip_prompt: strip prompt or not, defaults to True (yes, strip the prompt)</span>
<span class="sd">            expected_outputs: list of strings to look for in output; if any of these are seen,</span>
<span class="sd">                return output read up till that read</span>
<span class="sd">            read_duration: float duration to read for</span>

<span class="sd">        Returns:</span>
<span class="sd">            Tuple[bytes, bytes]: tuple of &quot;raw&quot; output and &quot;processed&quot; (cleaned up/stripped) output</span>

<span class="sd">        Raises:</span>
<span class="sd">            N/A</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_pre_send_input</span><span class="p">(</span><span class="n">channel_input</span><span class="o">=</span><span class="n">channel_input</span><span class="p">)</span>

        <span class="n">buf</span> <span class="o">=</span> <span class="sa">b</span><span class="s2">&quot;&quot;</span>
        <span class="n">bytes_channel_input</span> <span class="o">=</span> <span class="n">channel_input</span><span class="o">.</span><span class="n">encode</span><span class="p">()</span>
        <span class="n">bytes_channel_outputs</span> <span class="o">=</span> <span class="p">[</span>
            <span class="n">channel_output</span><span class="o">.</span><span class="n">encode</span><span class="p">()</span> <span class="k">for</span> <span class="n">channel_output</span> <span class="ow">in</span> <span class="n">expected_outputs</span> <span class="ow">or</span> <span class="p">[]</span>
        <span class="p">]</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;sending channel input and read: </span><span class="si">{</span><span class="n">channel_input</span><span class="si">}</span><span class="s2">; strip_prompt: </span><span class="si">{</span><span class="n">strip_prompt</span><span class="si">}</span><span class="s2">; &quot;</span>
            <span class="sa">f</span><span class="s2">&quot;expected_outputs: </span><span class="si">{</span><span class="n">expected_outputs</span><span class="si">}</span><span class="s2">; read_duration: </span><span class="si">{</span><span class="n">read_duration</span><span class="si">}</span><span class="s2">&quot;</span>
        <span class="p">)</span>

        <span class="k">async</span> <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">_channel_lock</span><span class="p">():</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">channel_input</span><span class="o">=</span><span class="n">channel_input</span><span class="p">)</span>
            <span class="n">_buf_until_input</span> <span class="o">=</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_read_until_input</span><span class="p">(</span><span class="n">channel_input</span><span class="o">=</span><span class="n">bytes_channel_input</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">send_return</span><span class="p">()</span>

            <span class="n">buf</span> <span class="o">+=</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_read_until_prompt_or_time</span><span class="p">(</span>
                <span class="n">channel_outputs</span><span class="o">=</span><span class="n">bytes_channel_outputs</span><span class="p">,</span> <span class="n">read_duration</span><span class="o">=</span><span class="n">read_duration</span>
            <span class="p">)</span>

        <span class="n">processed_buf</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_process_output</span><span class="p">(</span>
            <span class="n">buf</span><span class="o">=</span><span class="n">buf</span><span class="p">,</span>
            <span class="n">strip_prompt</span><span class="o">=</span><span class="n">strip_prompt</span><span class="p">,</span>
        <span class="p">)</span>

        <span class="k">return</span> <span class="n">buf</span><span class="p">,</span> <span class="n">processed_buf</span>

    <span class="nd">@timeout_wrapper</span>
    <span class="k">async</span> <span class="k">def</span> <span class="nf">send_inputs_interact</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">interact_events</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">Tuple</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">,</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">bool</span><span class="p">]]],</span>
        <span class="o">*</span><span class="p">,</span>
        <span class="n">interaction_complete_patterns</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="nb">bytes</span><span class="p">,</span> <span class="nb">bytes</span><span class="p">]:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Interact with a device with changing prompts per input.</span>

<span class="sd">        Used to interact with devices where prompts change per input, and where inputs may be hidden</span>
<span class="sd">        such as in the case of a password input. This can be used to respond to challenges from</span>
<span class="sd">        devices such as the confirmation for the command &quot;clear logging&quot; on IOSXE devices for</span>
<span class="sd">        example. You may have as many elements in the &quot;interact_events&quot; list as needed, and each</span>
<span class="sd">        element of that list should be a tuple of two or three elements. The first element is always</span>
<span class="sd">        the input to send as a string, the second should be the expected response as a string, and</span>
<span class="sd">        the optional third a bool for whether or not the input is &quot;hidden&quot; (i.e. password input)</span>

<span class="sd">        An example where we need this sort of capability:</span>

<span class="sd">        &#39;&#39;&#39;</span>
<span class="sd">        3560CX#copy flash: scp:</span>
<span class="sd">        Source filename []? test1.txt</span>
<span class="sd">        Address or name of remote host []? 172.31.254.100</span>
<span class="sd">        Destination username [carl]?</span>
<span class="sd">        Writing test1.txt</span>
<span class="sd">        Password:</span>

<span class="sd">        Password:</span>
<span class="sd">         Sink: C0644 639 test1.txt</span>
<span class="sd">        !</span>
<span class="sd">        639 bytes copied in 12.066 secs (53 bytes/sec)</span>
<span class="sd">        3560CX#</span>
<span class="sd">        &#39;&#39;&#39;</span>

<span class="sd">        To accomplish this we can use the following:</span>

<span class="sd">        &#39;&#39;&#39;</span>
<span class="sd">        interact = conn.channel.send_inputs_interact(</span>
<span class="sd">            [</span>
<span class="sd">                (&quot;copy flash: scp:&quot;, &quot;Source filename []?&quot;, False),</span>
<span class="sd">                (&quot;test1.txt&quot;, &quot;Address or name of remote host []?&quot;, False),</span>
<span class="sd">                (&quot;172.31.254.100&quot;, &quot;Destination username [carl]?&quot;, False),</span>
<span class="sd">                (&quot;carl&quot;, &quot;Password:&quot;, False),</span>
<span class="sd">                (&quot;super_secure_password&quot;, prompt, True),</span>
<span class="sd">            ]</span>
<span class="sd">        )</span>
<span class="sd">        &#39;&#39;&#39;</span>

<span class="sd">        If we needed to deal with more prompts we could simply continue adding tuples to the list of</span>
<span class="sd">        interact &quot;events&quot;.</span>

<span class="sd">        Args:</span>
<span class="sd">            interact_events: list of tuples containing the &quot;interactions&quot; with the device</span>
<span class="sd">                each list element must have an input and an expected response, and may have an</span>
<span class="sd">                optional bool for the third and final element -- the optional bool specifies if the</span>
<span class="sd">                input that is sent to the device is &quot;hidden&quot; (ex: password), if the hidden param is</span>
<span class="sd">                not provided it is assumed the input is &quot;normal&quot; (not hidden)</span>
<span class="sd">            interaction_complete_patterns: list of patterns, that if seen, indicate the interactive</span>
<span class="sd">                &quot;session&quot; has ended and we should exit the interactive session.</span>

<span class="sd">        Returns:</span>
<span class="sd">            Tuple[bytes, bytes]: output read from the channel with no whitespace trimming/cleaning,</span>
<span class="sd">                and the output read from the channel that has been &quot;cleaned up&quot;</span>

<span class="sd">        Raises:</span>
<span class="sd">            N/A</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_pre_send_inputs_interact</span><span class="p">(</span><span class="n">interact_events</span><span class="o">=</span><span class="n">interact_events</span><span class="p">)</span>

        <span class="n">buf</span> <span class="o">=</span> <span class="sa">b</span><span class="s2">&quot;&quot;</span>
        <span class="n">processed_buf</span> <span class="o">=</span> <span class="sa">b</span><span class="s2">&quot;&quot;</span>

        <span class="k">async</span> <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">_channel_lock</span><span class="p">():</span>
            <span class="k">for</span> <span class="n">interact_event</span> <span class="ow">in</span> <span class="n">interact_events</span><span class="p">:</span>
                <span class="n">channel_input</span> <span class="o">=</span> <span class="n">interact_event</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
                <span class="n">bytes_channel_input</span> <span class="o">=</span> <span class="n">channel_input</span><span class="o">.</span><span class="n">encode</span><span class="p">()</span>
                <span class="n">channel_response</span> <span class="o">=</span> <span class="n">interact_event</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
                <span class="n">prompts</span> <span class="o">=</span> <span class="p">[</span><span class="n">channel_response</span><span class="p">]</span>

                <span class="k">if</span> <span class="n">interaction_complete_patterns</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="n">prompts</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">interaction_complete_patterns</span><span class="p">)</span>

                <span class="k">try</span><span class="p">:</span>
                    <span class="n">hidden_input</span> <span class="o">=</span> <span class="n">interact_event</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
                <span class="k">except</span> <span class="ne">IndexError</span><span class="p">:</span>
                    <span class="n">hidden_input</span> <span class="o">=</span> <span class="kc">False</span>

                <span class="n">_channel_input</span> <span class="o">=</span> <span class="n">channel_input</span> <span class="k">if</span> <span class="ow">not</span> <span class="n">hidden_input</span> <span class="k">else</span> <span class="s2">&quot;REDACTED&quot;</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span>
                    <span class="sa">f</span><span class="s2">&quot;sending interactive input: </span><span class="si">{</span><span class="n">_channel_input</span><span class="si">}</span><span class="s2">; &quot;</span>
                    <span class="sa">f</span><span class="s2">&quot;expecting: </span><span class="si">{</span><span class="n">channel_response</span><span class="si">}</span><span class="s2">; &quot;</span>
                    <span class="sa">f</span><span class="s2">&quot;hidden_input: </span><span class="si">{</span><span class="n">hidden_input</span><span class="si">}</span><span class="s2">&quot;</span>
                <span class="p">)</span>

                <span class="bp">self</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">channel_input</span><span class="o">=</span><span class="n">channel_input</span><span class="p">,</span> <span class="n">redacted</span><span class="o">=</span><span class="nb">bool</span><span class="p">(</span><span class="n">hidden_input</span><span class="p">))</span>
                <span class="k">if</span> <span class="n">channel_response</span> <span class="ow">and</span> <span class="n">hidden_input</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">True</span><span class="p">:</span>
                    <span class="n">buf</span> <span class="o">+=</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_read_until_input</span><span class="p">(</span><span class="n">channel_input</span><span class="o">=</span><span class="n">bytes_channel_input</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">send_return</span><span class="p">()</span>
                <span class="n">buf</span> <span class="o">+=</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_read_until_explicit_prompt</span><span class="p">(</span><span class="n">prompts</span><span class="o">=</span><span class="n">prompts</span><span class="p">)</span>

        <span class="n">processed_buf</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_process_output</span><span class="p">(</span>
            <span class="n">buf</span><span class="o">=</span><span class="n">buf</span><span class="p">,</span>
            <span class="n">strip_prompt</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
        <span class="p">)</span>

        <span class="k">return</span> <span class="n">buf</span><span class="p">,</span> <span class="n">processed_buf</span>
</code></pre></div></td></tr></table></div>
        </details>

  

  <div class="doc doc-children">









<div class="doc doc-object doc-function">



<h3 id="channel.async_channel.AsyncChannel.channel_authenticate_ssh" class="doc doc-heading">
<code class="highlight language-python"><span class="n">channel_authenticate_ssh</span><span class="p">(</span><span class="n">auth_password</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">auth_private_key_passphrase</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-async"><code>async</code></small>
  </span>

<a href="#channel.async_channel.AsyncChannel.channel_authenticate_ssh" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>Handle SSH Authentication for transports that only operate "in the channel" (i.e. system)</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>auth_password</code></td>
          <td>
                <code>str</code>
          </td>
          <td><p>password to authenticate with</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>auth_private_key_passphrase</code></td>
          <td>
                <code>str</code>
          </td>
          <td><p>passphrase for ssh key if necessary</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code>None</code>
          </td>
          <td><p>None</p></td>
        </tr>
    </tbody>
  </table>

  <p><strong>Raises:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code><span title="scrapli.exceptions.ScrapliAuthenticationFailed">ScrapliAuthenticationFailed</span></code>
          </td>
          <td><p>if password prompt seen more than twice</p></td>
        </tr>
        <tr>
          <td>
                <code><span title="scrapli.exceptions.ScrapliAuthenticationFailed">ScrapliAuthenticationFailed</span></code>
          </td>
          <td><p>if passphrase prompt seen more than twice</p></td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>channel/async_channel.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">255</span>
<span class="normal">256</span>
<span class="normal">257</span>
<span class="normal">258</span>
<span class="normal">259</span>
<span class="normal">260</span>
<span class="normal">261</span>
<span class="normal">262</span>
<span class="normal">263</span>
<span class="normal">264</span>
<span class="normal">265</span>
<span class="normal">266</span>
<span class="normal">267</span>
<span class="normal">268</span>
<span class="normal">269</span>
<span class="normal">270</span>
<span class="normal">271</span>
<span class="normal">272</span>
<span class="normal">273</span>
<span class="normal">274</span>
<span class="normal">275</span>
<span class="normal">276</span>
<span class="normal">277</span>
<span class="normal">278</span>
<span class="normal">279</span>
<span class="normal">280</span>
<span class="normal">281</span>
<span class="normal">282</span>
<span class="normal">283</span>
<span class="normal">284</span>
<span class="normal">285</span>
<span class="normal">286</span>
<span class="normal">287</span>
<span class="normal">288</span>
<span class="normal">289</span>
<span class="normal">290</span>
<span class="normal">291</span>
<span class="normal">292</span>
<span class="normal">293</span>
<span class="normal">294</span>
<span class="normal">295</span>
<span class="normal">296</span>
<span class="normal">297</span>
<span class="normal">298</span>
<span class="normal">299</span>
<span class="normal">300</span>
<span class="normal">301</span>
<span class="normal">302</span>
<span class="normal">303</span>
<span class="normal">304</span>
<span class="normal">305</span>
<span class="normal">306</span>
<span class="normal">307</span>
<span class="normal">308</span>
<span class="normal">309</span>
<span class="normal">310</span>
<span class="normal">311</span>
<span class="normal">312</span>
<span class="normal">313</span>
<span class="normal">314</span>
<span class="normal">315</span>
<span class="normal">316</span>
<span class="normal">317</span>
<span class="normal">318</span>
<span class="normal">319</span>
<span class="normal">320</span>
<span class="normal">321</span>
<span class="normal">322</span>
<span class="normal">323</span>
<span class="normal">324</span>
<span class="normal">325</span>
<span class="normal">326</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@timeout_wrapper</span>
<span class="k">async</span> <span class="k">def</span> <span class="nf">channel_authenticate_ssh</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span> <span class="n">auth_password</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">auth_private_key_passphrase</span><span class="p">:</span> <span class="nb">str</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Handle SSH Authentication for transports that only operate &quot;in the channel&quot; (i.e. system)</span>

<span class="sd">    Args:</span>
<span class="sd">        auth_password: password to authenticate with</span>
<span class="sd">        auth_private_key_passphrase: passphrase for ssh key if necessary</span>

<span class="sd">    Returns:</span>
<span class="sd">        None</span>

<span class="sd">    Raises:</span>
<span class="sd">        ScrapliAuthenticationFailed: if password prompt seen more than twice</span>
<span class="sd">        ScrapliAuthenticationFailed: if passphrase prompt seen more than twice</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;attempting in channel ssh authentication&quot;</span><span class="p">)</span>

    <span class="n">password_count</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">passphrase_count</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">authenticate_buf</span> <span class="o">=</span> <span class="sa">b</span><span class="s2">&quot;&quot;</span>

    <span class="p">(</span>
        <span class="n">password_pattern</span><span class="p">,</span>
        <span class="n">passphrase_pattern</span><span class="p">,</span>
        <span class="n">prompt_pattern</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_pre_channel_authenticate_ssh</span><span class="p">()</span>

    <span class="k">async</span> <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">_channel_lock</span><span class="p">():</span>
        <span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">buf</span> <span class="o">=</span> <span class="k">await</span> <span class="n">asyncio</span><span class="o">.</span><span class="n">wait_for</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">read</span><span class="p">(),</span> <span class="n">timeout</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
            <span class="k">except</span> <span class="n">asyncio</span><span class="o">.</span><span class="n">TimeoutError</span><span class="p">:</span>
                <span class="n">buf</span> <span class="o">=</span> <span class="sa">b</span><span class="s2">&quot;&quot;</span>
            <span class="n">authenticate_buf</span> <span class="o">+=</span> <span class="n">buf</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>

            <span class="k">if</span> <span class="n">re</span><span class="o">.</span><span class="n">search</span><span class="p">(</span>
                <span class="n">pattern</span><span class="o">=</span><span class="n">password_pattern</span><span class="p">,</span>
                <span class="n">string</span><span class="o">=</span><span class="n">authenticate_buf</span><span class="p">,</span>
            <span class="p">):</span>
                <span class="c1"># clear the authentication buffer so we don&#39;t re-read the password prompt</span>
                <span class="n">authenticate_buf</span> <span class="o">=</span> <span class="sa">b</span><span class="s2">&quot;&quot;</span>
                <span class="n">password_count</span> <span class="o">+=</span> <span class="mi">1</span>
                <span class="k">if</span> <span class="n">password_count</span> <span class="o">&gt;</span> <span class="mi">2</span><span class="p">:</span>
                    <span class="n">msg</span> <span class="o">=</span> <span class="s2">&quot;password prompt seen more than once, assuming auth failed&quot;</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">critical</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>
                    <span class="k">raise</span> <span class="n">ScrapliAuthenticationFailed</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">channel_input</span><span class="o">=</span><span class="n">auth_password</span><span class="p">,</span> <span class="n">redacted</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">send_return</span><span class="p">()</span>

            <span class="k">if</span> <span class="n">re</span><span class="o">.</span><span class="n">search</span><span class="p">(</span>
                <span class="n">pattern</span><span class="o">=</span><span class="n">passphrase_pattern</span><span class="p">,</span>
                <span class="n">string</span><span class="o">=</span><span class="n">authenticate_buf</span><span class="p">,</span>
            <span class="p">):</span>
                <span class="c1"># clear the authentication buffer so we don&#39;t re-read the passphrase prompt</span>
                <span class="n">authenticate_buf</span> <span class="o">=</span> <span class="sa">b</span><span class="s2">&quot;&quot;</span>
                <span class="n">passphrase_count</span> <span class="o">+=</span> <span class="mi">1</span>
                <span class="k">if</span> <span class="n">passphrase_count</span> <span class="o">&gt;</span> <span class="mi">2</span><span class="p">:</span>
                    <span class="n">msg</span> <span class="o">=</span> <span class="s2">&quot;passphrase prompt seen more than once, assuming auth failed&quot;</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">critical</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>
                    <span class="k">raise</span> <span class="n">ScrapliAuthenticationFailed</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">channel_input</span><span class="o">=</span><span class="n">auth_private_key_passphrase</span><span class="p">,</span> <span class="n">redacted</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">send_return</span><span class="p">()</span>

            <span class="k">if</span> <span class="n">re</span><span class="o">.</span><span class="n">search</span><span class="p">(</span>
                <span class="n">pattern</span><span class="o">=</span><span class="n">prompt_pattern</span><span class="p">,</span>
                <span class="n">string</span><span class="o">=</span><span class="n">authenticate_buf</span><span class="p">,</span>
            <span class="p">):</span>
                <span class="k">return</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h3 id="channel.async_channel.AsyncChannel.channel_authenticate_telnet" class="doc doc-heading">
<code class="highlight language-python"><span class="n">channel_authenticate_telnet</span><span class="p">(</span><span class="n">auth_username</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">auth_password</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-async"><code>async</code></small>
  </span>

<a href="#channel.async_channel.AsyncChannel.channel_authenticate_telnet" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>Handle Telnet Authentication</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>auth_username</code></td>
          <td>
                <code>str</code>
          </td>
          <td><p>username to use for telnet authentication</p></td>
          <td>
                <code>&#39;&#39;</code>
          </td>
        </tr>
        <tr>
          <td><code>auth_password</code></td>
          <td>
                <code>str</code>
          </td>
          <td><p>password to use for telnet authentication</p></td>
          <td>
                <code>&#39;&#39;</code>
          </td>
        </tr>
    </tbody>
  </table>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code>None</code>
          </td>
          <td><p>None</p></td>
        </tr>
    </tbody>
  </table>

  <p><strong>Raises:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code><span title="scrapli.exceptions.ScrapliAuthenticationFailed">ScrapliAuthenticationFailed</span></code>
          </td>
          <td><p>if password prompt seen more than twice</p></td>
        </tr>
        <tr>
          <td>
                <code><span title="scrapli.exceptions.ScrapliAuthenticationFailed">ScrapliAuthenticationFailed</span></code>
          </td>
          <td><p>if login prompt seen more than twice</p></td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>channel/async_channel.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">328</span>
<span class="normal">329</span>
<span class="normal">330</span>
<span class="normal">331</span>
<span class="normal">332</span>
<span class="normal">333</span>
<span class="normal">334</span>
<span class="normal">335</span>
<span class="normal">336</span>
<span class="normal">337</span>
<span class="normal">338</span>
<span class="normal">339</span>
<span class="normal">340</span>
<span class="normal">341</span>
<span class="normal">342</span>
<span class="normal">343</span>
<span class="normal">344</span>
<span class="normal">345</span>
<span class="normal">346</span>
<span class="normal">347</span>
<span class="normal">348</span>
<span class="normal">349</span>
<span class="normal">350</span>
<span class="normal">351</span>
<span class="normal">352</span>
<span class="normal">353</span>
<span class="normal">354</span>
<span class="normal">355</span>
<span class="normal">356</span>
<span class="normal">357</span>
<span class="normal">358</span>
<span class="normal">359</span>
<span class="normal">360</span>
<span class="normal">361</span>
<span class="normal">362</span>
<span class="normal">363</span>
<span class="normal">364</span>
<span class="normal">365</span>
<span class="normal">366</span>
<span class="normal">367</span>
<span class="normal">368</span>
<span class="normal">369</span>
<span class="normal">370</span>
<span class="normal">371</span>
<span class="normal">372</span>
<span class="normal">373</span>
<span class="normal">374</span>
<span class="normal">375</span>
<span class="normal">376</span>
<span class="normal">377</span>
<span class="normal">378</span>
<span class="normal">379</span>
<span class="normal">380</span>
<span class="normal">381</span>
<span class="normal">382</span>
<span class="normal">383</span>
<span class="normal">384</span>
<span class="normal">385</span>
<span class="normal">386</span>
<span class="normal">387</span>
<span class="normal">388</span>
<span class="normal">389</span>
<span class="normal">390</span>
<span class="normal">391</span>
<span class="normal">392</span>
<span class="normal">393</span>
<span class="normal">394</span>
<span class="normal">395</span>
<span class="normal">396</span>
<span class="normal">397</span>
<span class="normal">398</span>
<span class="normal">399</span>
<span class="normal">400</span>
<span class="normal">401</span>
<span class="normal">402</span>
<span class="normal">403</span>
<span class="normal">404</span>
<span class="normal">405</span>
<span class="normal">406</span>
<span class="normal">407</span>
<span class="normal">408</span>
<span class="normal">409</span>
<span class="normal">410</span>
<span class="normal">411</span>
<span class="normal">412</span>
<span class="normal">413</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@timeout_wrapper</span>
<span class="k">async</span> <span class="k">def</span> <span class="nf">channel_authenticate_telnet</span><span class="p">(</span>  <span class="c1"># noqa: C901</span>
    <span class="bp">self</span><span class="p">,</span> <span class="n">auth_username</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">auth_password</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Handle Telnet Authentication</span>

<span class="sd">    Args:</span>
<span class="sd">        auth_username: username to use for telnet authentication</span>
<span class="sd">        auth_password: password to use for telnet authentication</span>

<span class="sd">    Returns:</span>
<span class="sd">        None</span>

<span class="sd">    Raises:</span>
<span class="sd">        ScrapliAuthenticationFailed: if password prompt seen more than twice</span>
<span class="sd">        ScrapliAuthenticationFailed: if login prompt seen more than twice</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;attempting in channel telnet authentication&quot;</span><span class="p">)</span>

    <span class="n">username_count</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">password_count</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">authenticate_buf</span> <span class="o">=</span> <span class="sa">b</span><span class="s2">&quot;&quot;</span>

    <span class="p">(</span>
        <span class="n">username_pattern</span><span class="p">,</span>
        <span class="n">password_pattern</span><span class="p">,</span>
        <span class="n">prompt_pattern</span><span class="p">,</span>
        <span class="n">auth_start_time</span><span class="p">,</span>
        <span class="n">return_interval</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_pre_channel_authenticate_telnet</span><span class="p">()</span>

    <span class="n">read_interval</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_base_channel_args</span><span class="o">.</span><span class="n">timeout_ops</span> <span class="o">/</span> <span class="mi">20</span>
    <span class="n">return_attempts</span> <span class="o">=</span> <span class="mi">1</span>

    <span class="k">async</span> <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">_channel_lock</span><span class="p">():</span>
        <span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">buf</span> <span class="o">=</span> <span class="k">await</span> <span class="n">asyncio</span><span class="o">.</span><span class="n">wait_for</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">read</span><span class="p">(),</span> <span class="n">timeout</span><span class="o">=</span><span class="n">read_interval</span><span class="p">)</span>
            <span class="k">except</span> <span class="n">asyncio</span><span class="o">.</span><span class="n">TimeoutError</span><span class="p">:</span>
                <span class="n">buf</span> <span class="o">=</span> <span class="sa">b</span><span class="s2">&quot;&quot;</span>

            <span class="k">if</span> <span class="ow">not</span> <span class="n">buf</span><span class="p">:</span>
                <span class="n">current_iteration_time</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span><span class="o">.</span><span class="n">timestamp</span><span class="p">()</span>
                <span class="k">if</span> <span class="p">(</span><span class="n">current_iteration_time</span> <span class="o">-</span> <span class="n">auth_start_time</span><span class="p">)</span> <span class="o">&gt;</span> <span class="p">(</span>
                    <span class="n">return_interval</span> <span class="o">*</span> <span class="n">return_attempts</span>
                <span class="p">):</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">send_return</span><span class="p">()</span>
                    <span class="n">return_attempts</span> <span class="o">+=</span> <span class="mi">1</span>

            <span class="n">authenticate_buf</span> <span class="o">+=</span> <span class="n">buf</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>

            <span class="k">if</span> <span class="n">re</span><span class="o">.</span><span class="n">search</span><span class="p">(</span>
                <span class="n">pattern</span><span class="o">=</span><span class="n">username_pattern</span><span class="p">,</span>
                <span class="n">string</span><span class="o">=</span><span class="n">authenticate_buf</span><span class="p">,</span>
            <span class="p">):</span>
                <span class="c1"># clear the authentication buffer so we don&#39;t re-read the username prompt</span>
                <span class="n">authenticate_buf</span> <span class="o">=</span> <span class="sa">b</span><span class="s2">&quot;&quot;</span>
                <span class="n">username_count</span> <span class="o">+=</span> <span class="mi">1</span>
                <span class="k">if</span> <span class="n">username_count</span> <span class="o">&gt;</span> <span class="mi">2</span><span class="p">:</span>
                    <span class="n">msg</span> <span class="o">=</span> <span class="s2">&quot;username/login prompt seen more than once, assuming auth failed&quot;</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">critical</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>
                    <span class="k">raise</span> <span class="n">ScrapliAuthenticationFailed</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">channel_input</span><span class="o">=</span><span class="n">auth_username</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">send_return</span><span class="p">()</span>

            <span class="k">if</span> <span class="n">re</span><span class="o">.</span><span class="n">search</span><span class="p">(</span>
                <span class="n">pattern</span><span class="o">=</span><span class="n">password_pattern</span><span class="p">,</span>
                <span class="n">string</span><span class="o">=</span><span class="n">authenticate_buf</span><span class="p">,</span>
            <span class="p">):</span>
                <span class="c1"># clear the authentication buffer so we don&#39;t re-read the password prompt</span>
                <span class="n">authenticate_buf</span> <span class="o">=</span> <span class="sa">b</span><span class="s2">&quot;&quot;</span>
                <span class="n">password_count</span> <span class="o">+=</span> <span class="mi">1</span>
                <span class="k">if</span> <span class="n">password_count</span> <span class="o">&gt;</span> <span class="mi">2</span><span class="p">:</span>
                    <span class="n">msg</span> <span class="o">=</span> <span class="s2">&quot;password prompt seen more than once, assuming auth failed&quot;</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">critical</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>
                    <span class="k">raise</span> <span class="n">ScrapliAuthenticationFailed</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">channel_input</span><span class="o">=</span><span class="n">auth_password</span><span class="p">,</span> <span class="n">redacted</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">send_return</span><span class="p">()</span>

            <span class="k">if</span> <span class="n">re</span><span class="o">.</span><span class="n">search</span><span class="p">(</span>
                <span class="n">pattern</span><span class="o">=</span><span class="n">prompt_pattern</span><span class="p">,</span>
                <span class="n">string</span><span class="o">=</span><span class="n">authenticate_buf</span><span class="p">,</span>
            <span class="p">):</span>
                <span class="k">return</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h3 id="channel.async_channel.AsyncChannel.get_prompt" class="doc doc-heading">
<code class="highlight language-python"><span class="n">get_prompt</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="nb">str</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-async"><code>async</code></small>
  </span>

<a href="#channel.async_channel.AsyncChannel.get_prompt" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>Get current channel prompt</p>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
<th>Name</th>        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
<td><code>str</code></td>          <td>
                <code>str</code>
          </td>
          <td><p>string of the current prompt</p></td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>channel/async_channel.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">415</span>
<span class="normal">416</span>
<span class="normal">417</span>
<span class="normal">418</span>
<span class="normal">419</span>
<span class="normal">420</span>
<span class="normal">421</span>
<span class="normal">422</span>
<span class="normal">423</span>
<span class="normal">424</span>
<span class="normal">425</span>
<span class="normal">426</span>
<span class="normal">427</span>
<span class="normal">428</span>
<span class="normal">429</span>
<span class="normal">430</span>
<span class="normal">431</span>
<span class="normal">432</span>
<span class="normal">433</span>
<span class="normal">434</span>
<span class="normal">435</span>
<span class="normal">436</span>
<span class="normal">437</span>
<span class="normal">438</span>
<span class="normal">439</span>
<span class="normal">440</span>
<span class="normal">441</span>
<span class="normal">442</span>
<span class="normal">443</span>
<span class="normal">444</span>
<span class="normal">445</span>
<span class="normal">446</span>
<span class="normal">447</span>
<span class="normal">448</span>
<span class="normal">449</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@timeout_wrapper</span>
<span class="k">async</span> <span class="k">def</span> <span class="nf">get_prompt</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Get current channel prompt</span>

<span class="sd">    Args:</span>
<span class="sd">        N/A</span>

<span class="sd">    Returns:</span>
<span class="sd">        str: string of the current prompt</span>

<span class="sd">    Raises:</span>
<span class="sd">        N/A</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">buf</span> <span class="o">=</span> <span class="sa">b</span><span class="s2">&quot;&quot;</span>

    <span class="n">search_pattern</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_prompt_pattern</span><span class="p">(</span>
        <span class="n">class_pattern</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_base_channel_args</span><span class="o">.</span><span class="n">comms_prompt_pattern</span>
    <span class="p">)</span>

    <span class="k">async</span> <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">_channel_lock</span><span class="p">():</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">send_return</span><span class="p">()</span>

        <span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
            <span class="n">buf</span> <span class="o">+=</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>

            <span class="n">channel_match</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">search</span><span class="p">(</span>
                <span class="n">pattern</span><span class="o">=</span><span class="n">search_pattern</span><span class="p">,</span>
                <span class="n">string</span><span class="o">=</span><span class="n">buf</span><span class="p">,</span>
            <span class="p">)</span>

            <span class="k">if</span> <span class="n">channel_match</span><span class="p">:</span>
                <span class="n">current_prompt</span> <span class="o">=</span> <span class="n">channel_match</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
                <span class="k">return</span> <span class="n">current_prompt</span><span class="o">.</span><span class="n">decode</span><span class="p">()</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h3 id="channel.async_channel.AsyncChannel.read" class="doc doc-heading">
<code class="highlight language-python"><span class="n">read</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="nb">bytes</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-async"><code>async</code></small>
  </span>

<a href="#channel.async_channel.AsyncChannel.read" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>Read chunks of output from the channel</p>
<p>Replaces any \r characters that sometimes get stuffed into the output from the devices</p>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
<th>Name</th>        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
<td><code>bytes</code></td>          <td>
                <code>bytes</code>
          </td>
          <td><p>output read from channel</p></td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>channel/async_channel.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span>
<span class="normal">67</span>
<span class="normal">68</span>
<span class="normal">69</span>
<span class="normal">70</span>
<span class="normal">71</span>
<span class="normal">72</span>
<span class="normal">73</span>
<span class="normal">74</span>
<span class="normal">75</span>
<span class="normal">76</span>
<span class="normal">77</span>
<span class="normal">78</span>
<span class="normal">79</span>
<span class="normal">80</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">async</span> <span class="k">def</span> <span class="nf">read</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bytes</span><span class="p">:</span>
    <span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Read chunks of output from the channel</span>

<span class="sd">    Replaces any \r characters that sometimes get stuffed into the output from the devices</span>

<span class="sd">    Args:</span>
<span class="sd">        N/A</span>

<span class="sd">    Returns:</span>
<span class="sd">        bytes: output read from channel</span>

<span class="sd">    Raises:</span>
<span class="sd">        N/A</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">buf</span> <span class="o">=</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">transport</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
    <span class="n">buf</span> <span class="o">=</span> <span class="n">buf</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="sa">b</span><span class="s2">&quot;</span><span class="se">\r</span><span class="s2">&quot;</span><span class="p">,</span> <span class="sa">b</span><span class="s2">&quot;&quot;</span><span class="p">)</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;read: </span><span class="si">{</span><span class="n">buf</span><span class="si">!r}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">channel_log</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">channel_log</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">buf</span><span class="p">)</span>

    <span class="k">if</span> <span class="sa">b</span><span class="s2">&quot;</span><span class="se">\x1b</span><span class="s2">&quot;</span> <span class="ow">in</span> <span class="n">buf</span><span class="o">.</span><span class="n">lower</span><span class="p">():</span>
        <span class="n">buf</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_strip_ansi</span><span class="p">(</span><span class="n">buf</span><span class="o">=</span><span class="n">buf</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">buf</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h3 id="channel.async_channel.AsyncChannel.send_input" class="doc doc-heading">
<code class="highlight language-python"><span class="n">send_input</span><span class="p">(</span><span class="n">channel_input</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">strip_prompt</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="n">eager</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="nb">bytes</span><span class="p">,</span> <span class="nb">bytes</span><span class="p">]</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-async"><code>async</code></small>
  </span>

<a href="#channel.async_channel.AsyncChannel.send_input" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>Primary entry point to send data to devices in shell mode; accept input and returns result</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>channel_input</code></td>
          <td>
                <code>str</code>
          </td>
          <td><p>string input to send to channel</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>strip_prompt</code></td>
          <td>
                <code>bool</code>
          </td>
          <td><p>strip prompt or not, defaults to True (yes, strip the prompt)</p></td>
          <td>
                <code>True</code>
          </td>
        </tr>
        <tr>
          <td><code>eager</code></td>
          <td>
                <code>bool</code>
          </td>
          <td><p>eager mode reads and returns the <code>_read_until_input</code> value, but does not attempt
to read to the prompt pattern -- this should not be used manually! (only used by
<code>send_configs</code> with the eager flag set)</p></td>
          <td>
                <code>False</code>
          </td>
        </tr>
    </tbody>
  </table>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code><span title="typing.Tuple">Tuple</span>[bytes, bytes]</code>
          </td>
          <td><p>Tuple[bytes, bytes]: tuple of "raw" output and "processed" (cleaned up/stripped) output</p></td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>channel/async_channel.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">451</span>
<span class="normal">452</span>
<span class="normal">453</span>
<span class="normal">454</span>
<span class="normal">455</span>
<span class="normal">456</span>
<span class="normal">457</span>
<span class="normal">458</span>
<span class="normal">459</span>
<span class="normal">460</span>
<span class="normal">461</span>
<span class="normal">462</span>
<span class="normal">463</span>
<span class="normal">464</span>
<span class="normal">465</span>
<span class="normal">466</span>
<span class="normal">467</span>
<span class="normal">468</span>
<span class="normal">469</span>
<span class="normal">470</span>
<span class="normal">471</span>
<span class="normal">472</span>
<span class="normal">473</span>
<span class="normal">474</span>
<span class="normal">475</span>
<span class="normal">476</span>
<span class="normal">477</span>
<span class="normal">478</span>
<span class="normal">479</span>
<span class="normal">480</span>
<span class="normal">481</span>
<span class="normal">482</span>
<span class="normal">483</span>
<span class="normal">484</span>
<span class="normal">485</span>
<span class="normal">486</span>
<span class="normal">487</span>
<span class="normal">488</span>
<span class="normal">489</span>
<span class="normal">490</span>
<span class="normal">491</span>
<span class="normal">492</span>
<span class="normal">493</span>
<span class="normal">494</span>
<span class="normal">495</span>
<span class="normal">496</span>
<span class="normal">497</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@timeout_wrapper</span>
<span class="k">async</span> <span class="k">def</span> <span class="nf">send_input</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">channel_input</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="o">*</span><span class="p">,</span>
    <span class="n">strip_prompt</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">eager</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="nb">bytes</span><span class="p">,</span> <span class="nb">bytes</span><span class="p">]:</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Primary entry point to send data to devices in shell mode; accept input and returns result</span>

<span class="sd">    Args:</span>
<span class="sd">        channel_input: string input to send to channel</span>
<span class="sd">        strip_prompt: strip prompt or not, defaults to True (yes, strip the prompt)</span>
<span class="sd">        eager: eager mode reads and returns the `_read_until_input` value, but does not attempt</span>
<span class="sd">            to read to the prompt pattern -- this should not be used manually! (only used by</span>
<span class="sd">            `send_configs` with the eager flag set)</span>

<span class="sd">    Returns:</span>
<span class="sd">        Tuple[bytes, bytes]: tuple of &quot;raw&quot; output and &quot;processed&quot; (cleaned up/stripped) output</span>

<span class="sd">    Raises:</span>
<span class="sd">        N/A</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_pre_send_input</span><span class="p">(</span><span class="n">channel_input</span><span class="o">=</span><span class="n">channel_input</span><span class="p">)</span>

    <span class="n">buf</span> <span class="o">=</span> <span class="sa">b</span><span class="s2">&quot;&quot;</span>
    <span class="n">bytes_channel_input</span> <span class="o">=</span> <span class="n">channel_input</span><span class="o">.</span><span class="n">encode</span><span class="p">()</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span>
        <span class="sa">f</span><span class="s2">&quot;sending channel input: </span><span class="si">{</span><span class="n">channel_input</span><span class="si">}</span><span class="s2">; strip_prompt: </span><span class="si">{</span><span class="n">strip_prompt</span><span class="si">}</span><span class="s2">; eager: </span><span class="si">{</span><span class="n">eager</span><span class="si">}</span><span class="s2">&quot;</span>
    <span class="p">)</span>

    <span class="k">async</span> <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">_channel_lock</span><span class="p">():</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">channel_input</span><span class="o">=</span><span class="n">channel_input</span><span class="p">)</span>
        <span class="n">_buf_until_input</span> <span class="o">=</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_read_until_input</span><span class="p">(</span><span class="n">channel_input</span><span class="o">=</span><span class="n">bytes_channel_input</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">send_return</span><span class="p">()</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">eager</span><span class="p">:</span>
            <span class="n">buf</span> <span class="o">+=</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_read_until_prompt</span><span class="p">()</span>

    <span class="n">processed_buf</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_process_output</span><span class="p">(</span>
        <span class="n">buf</span><span class="o">=</span><span class="n">buf</span><span class="p">,</span>
        <span class="n">strip_prompt</span><span class="o">=</span><span class="n">strip_prompt</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="k">return</span> <span class="n">buf</span><span class="p">,</span> <span class="n">processed_buf</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h3 id="channel.async_channel.AsyncChannel.send_input_and_read" class="doc doc-heading">
<code class="highlight language-python"><span class="n">send_input_and_read</span><span class="p">(</span><span class="n">channel_input</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">strip_prompt</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="n">expected_outputs</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">read_duration</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="nb">bytes</span><span class="p">,</span> <span class="nb">bytes</span><span class="p">]</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-async"><code>async</code></small>
  </span>

<a href="#channel.async_channel.AsyncChannel.send_input_and_read" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>Send a command and read until expected prompt is seen, outputs are seen, or for duration</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>channel_input</code></td>
          <td>
                <code>str</code>
          </td>
          <td><p>string input to send to channel</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>strip_prompt</code></td>
          <td>
                <code>bool</code>
          </td>
          <td><p>strip prompt or not, defaults to True (yes, strip the prompt)</p></td>
          <td>
                <code>True</code>
          </td>
        </tr>
        <tr>
          <td><code>expected_outputs</code></td>
          <td>
                <code><span title="typing.Optional">Optional</span>[<span title="typing.List">List</span>[str]]</code>
          </td>
          <td><p>list of strings to look for in output; if any of these are seen,
return output read up till that read</p></td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>read_duration</code></td>
          <td>
                <code><span title="typing.Optional">Optional</span>[float]</code>
          </td>
          <td><p>float duration to read for</p></td>
          <td>
                <code>None</code>
          </td>
        </tr>
    </tbody>
  </table>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code><span title="typing.Tuple">Tuple</span>[bytes, bytes]</code>
          </td>
          <td><p>Tuple[bytes, bytes]: tuple of "raw" output and "processed" (cleaned up/stripped) output</p></td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>channel/async_channel.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">499</span>
<span class="normal">500</span>
<span class="normal">501</span>
<span class="normal">502</span>
<span class="normal">503</span>
<span class="normal">504</span>
<span class="normal">505</span>
<span class="normal">506</span>
<span class="normal">507</span>
<span class="normal">508</span>
<span class="normal">509</span>
<span class="normal">510</span>
<span class="normal">511</span>
<span class="normal">512</span>
<span class="normal">513</span>
<span class="normal">514</span>
<span class="normal">515</span>
<span class="normal">516</span>
<span class="normal">517</span>
<span class="normal">518</span>
<span class="normal">519</span>
<span class="normal">520</span>
<span class="normal">521</span>
<span class="normal">522</span>
<span class="normal">523</span>
<span class="normal">524</span>
<span class="normal">525</span>
<span class="normal">526</span>
<span class="normal">527</span>
<span class="normal">528</span>
<span class="normal">529</span>
<span class="normal">530</span>
<span class="normal">531</span>
<span class="normal">532</span>
<span class="normal">533</span>
<span class="normal">534</span>
<span class="normal">535</span>
<span class="normal">536</span>
<span class="normal">537</span>
<span class="normal">538</span>
<span class="normal">539</span>
<span class="normal">540</span>
<span class="normal">541</span>
<span class="normal">542</span>
<span class="normal">543</span>
<span class="normal">544</span>
<span class="normal">545</span>
<span class="normal">546</span>
<span class="normal">547</span>
<span class="normal">548</span>
<span class="normal">549</span>
<span class="normal">550</span>
<span class="normal">551</span>
<span class="normal">552</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@timeout_wrapper</span>
<span class="k">async</span> <span class="k">def</span> <span class="nf">send_input_and_read</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">channel_input</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="o">*</span><span class="p">,</span>
    <span class="n">strip_prompt</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">expected_outputs</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">read_duration</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="nb">bytes</span><span class="p">,</span> <span class="nb">bytes</span><span class="p">]:</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Send a command and read until expected prompt is seen, outputs are seen, or for duration</span>

<span class="sd">    Args:</span>
<span class="sd">        channel_input: string input to send to channel</span>
<span class="sd">        strip_prompt: strip prompt or not, defaults to True (yes, strip the prompt)</span>
<span class="sd">        expected_outputs: list of strings to look for in output; if any of these are seen,</span>
<span class="sd">            return output read up till that read</span>
<span class="sd">        read_duration: float duration to read for</span>

<span class="sd">    Returns:</span>
<span class="sd">        Tuple[bytes, bytes]: tuple of &quot;raw&quot; output and &quot;processed&quot; (cleaned up/stripped) output</span>

<span class="sd">    Raises:</span>
<span class="sd">        N/A</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_pre_send_input</span><span class="p">(</span><span class="n">channel_input</span><span class="o">=</span><span class="n">channel_input</span><span class="p">)</span>

    <span class="n">buf</span> <span class="o">=</span> <span class="sa">b</span><span class="s2">&quot;&quot;</span>
    <span class="n">bytes_channel_input</span> <span class="o">=</span> <span class="n">channel_input</span><span class="o">.</span><span class="n">encode</span><span class="p">()</span>
    <span class="n">bytes_channel_outputs</span> <span class="o">=</span> <span class="p">[</span>
        <span class="n">channel_output</span><span class="o">.</span><span class="n">encode</span><span class="p">()</span> <span class="k">for</span> <span class="n">channel_output</span> <span class="ow">in</span> <span class="n">expected_outputs</span> <span class="ow">or</span> <span class="p">[]</span>
    <span class="p">]</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span>
        <span class="sa">f</span><span class="s2">&quot;sending channel input and read: </span><span class="si">{</span><span class="n">channel_input</span><span class="si">}</span><span class="s2">; strip_prompt: </span><span class="si">{</span><span class="n">strip_prompt</span><span class="si">}</span><span class="s2">; &quot;</span>
        <span class="sa">f</span><span class="s2">&quot;expected_outputs: </span><span class="si">{</span><span class="n">expected_outputs</span><span class="si">}</span><span class="s2">; read_duration: </span><span class="si">{</span><span class="n">read_duration</span><span class="si">}</span><span class="s2">&quot;</span>
    <span class="p">)</span>

    <span class="k">async</span> <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">_channel_lock</span><span class="p">():</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">channel_input</span><span class="o">=</span><span class="n">channel_input</span><span class="p">)</span>
        <span class="n">_buf_until_input</span> <span class="o">=</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_read_until_input</span><span class="p">(</span><span class="n">channel_input</span><span class="o">=</span><span class="n">bytes_channel_input</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">send_return</span><span class="p">()</span>

        <span class="n">buf</span> <span class="o">+=</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_read_until_prompt_or_time</span><span class="p">(</span>
            <span class="n">channel_outputs</span><span class="o">=</span><span class="n">bytes_channel_outputs</span><span class="p">,</span> <span class="n">read_duration</span><span class="o">=</span><span class="n">read_duration</span>
        <span class="p">)</span>

    <span class="n">processed_buf</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_process_output</span><span class="p">(</span>
        <span class="n">buf</span><span class="o">=</span><span class="n">buf</span><span class="p">,</span>
        <span class="n">strip_prompt</span><span class="o">=</span><span class="n">strip_prompt</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="k">return</span> <span class="n">buf</span><span class="p">,</span> <span class="n">processed_buf</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h3 id="channel.async_channel.AsyncChannel.send_inputs_interact" class="doc doc-heading">
<code class="highlight language-python"><span class="n">send_inputs_interact</span><span class="p">(</span><span class="n">interact_events</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">Tuple</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">,</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">bool</span><span class="p">]]],</span> <span class="o">*</span><span class="p">,</span> <span class="n">interaction_complete_patterns</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="nb">bytes</span><span class="p">,</span> <span class="nb">bytes</span><span class="p">]</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-async"><code>async</code></small>
  </span>

<a href="#channel.async_channel.AsyncChannel.send_inputs_interact" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>Interact with a device with changing prompts per input.</p>
<p>Used to interact with devices where prompts change per input, and where inputs may be hidden
such as in the case of a password input. This can be used to respond to challenges from
devices such as the confirmation for the command "clear logging" on IOSXE devices for
example. You may have as many elements in the "interact_events" list as needed, and each
element of that list should be a tuple of two or three elements. The first element is always
the input to send as a string, the second should be the expected response as a string, and
the optional third a bool for whether or not the input is "hidden" (i.e. password input)</p>
<p>An example where we need this sort of capability:</p>
<p>'''
3560CX#copy flash: scp:
Source filename []? test1.txt
Address or name of remote host []? 172.31.254.100
Destination username [carl]?
Writing test1.txt
Password:</p>

<details class="password">
  <summary>Password</summary>
  <p>Sink: C0644 639 test1.txt</p>
</details>      <p>!
639 bytes copied in 12.066 secs (53 bytes/sec)
3560CX#
'''</p>
<p>To accomplish this we can use the following:</p>
<p>'''
interact = conn.channel.send_inputs_interact(
    [
        ("copy flash: scp:", "Source filename []?", False),
        ("test1.txt", "Address or name of remote host []?", False),
        ("172.31.254.100", "Destination username [carl]?", False),
        ("carl", "Password:", False),
        ("super_secure_password", prompt, True),
    ]
)
'''</p>
<p>If we needed to deal with more prompts we could simply continue adding tuples to the list of
interact "events".</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>interact_events</code></td>
          <td>
                <code><span title="typing.List">List</span>[<span title="typing.Tuple">Tuple</span>[str, str, <span title="typing.Optional">Optional</span>[bool]]]</code>
          </td>
          <td><p>list of tuples containing the "interactions" with the device
each list element must have an input and an expected response, and may have an
optional bool for the third and final element -- the optional bool specifies if the
input that is sent to the device is "hidden" (ex: password), if the hidden param is
not provided it is assumed the input is "normal" (not hidden)</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>interaction_complete_patterns</code></td>
          <td>
                <code><span title="typing.Optional">Optional</span>[<span title="typing.List">List</span>[str]]</code>
          </td>
          <td><p>list of patterns, that if seen, indicate the interactive
"session" has ended and we should exit the interactive session.</p></td>
          <td>
                <code>None</code>
          </td>
        </tr>
    </tbody>
  </table>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code><span title="typing.Tuple">Tuple</span>[bytes, bytes]</code>
          </td>
          <td><p>Tuple[bytes, bytes]: output read from the channel with no whitespace trimming/cleaning,
and the output read from the channel that has been "cleaned up"</p></td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>channel/async_channel.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">554</span>
<span class="normal">555</span>
<span class="normal">556</span>
<span class="normal">557</span>
<span class="normal">558</span>
<span class="normal">559</span>
<span class="normal">560</span>
<span class="normal">561</span>
<span class="normal">562</span>
<span class="normal">563</span>
<span class="normal">564</span>
<span class="normal">565</span>
<span class="normal">566</span>
<span class="normal">567</span>
<span class="normal">568</span>
<span class="normal">569</span>
<span class="normal">570</span>
<span class="normal">571</span>
<span class="normal">572</span>
<span class="normal">573</span>
<span class="normal">574</span>
<span class="normal">575</span>
<span class="normal">576</span>
<span class="normal">577</span>
<span class="normal">578</span>
<span class="normal">579</span>
<span class="normal">580</span>
<span class="normal">581</span>
<span class="normal">582</span>
<span class="normal">583</span>
<span class="normal">584</span>
<span class="normal">585</span>
<span class="normal">586</span>
<span class="normal">587</span>
<span class="normal">588</span>
<span class="normal">589</span>
<span class="normal">590</span>
<span class="normal">591</span>
<span class="normal">592</span>
<span class="normal">593</span>
<span class="normal">594</span>
<span class="normal">595</span>
<span class="normal">596</span>
<span class="normal">597</span>
<span class="normal">598</span>
<span class="normal">599</span>
<span class="normal">600</span>
<span class="normal">601</span>
<span class="normal">602</span>
<span class="normal">603</span>
<span class="normal">604</span>
<span class="normal">605</span>
<span class="normal">606</span>
<span class="normal">607</span>
<span class="normal">608</span>
<span class="normal">609</span>
<span class="normal">610</span>
<span class="normal">611</span>
<span class="normal">612</span>
<span class="normal">613</span>
<span class="normal">614</span>
<span class="normal">615</span>
<span class="normal">616</span>
<span class="normal">617</span>
<span class="normal">618</span>
<span class="normal">619</span>
<span class="normal">620</span>
<span class="normal">621</span>
<span class="normal">622</span>
<span class="normal">623</span>
<span class="normal">624</span>
<span class="normal">625</span>
<span class="normal">626</span>
<span class="normal">627</span>
<span class="normal">628</span>
<span class="normal">629</span>
<span class="normal">630</span>
<span class="normal">631</span>
<span class="normal">632</span>
<span class="normal">633</span>
<span class="normal">634</span>
<span class="normal">635</span>
<span class="normal">636</span>
<span class="normal">637</span>
<span class="normal">638</span>
<span class="normal">639</span>
<span class="normal">640</span>
<span class="normal">641</span>
<span class="normal">642</span>
<span class="normal">643</span>
<span class="normal">644</span>
<span class="normal">645</span>
<span class="normal">646</span>
<span class="normal">647</span>
<span class="normal">648</span>
<span class="normal">649</span>
<span class="normal">650</span>
<span class="normal">651</span>
<span class="normal">652</span>
<span class="normal">653</span>
<span class="normal">654</span>
<span class="normal">655</span>
<span class="normal">656</span>
<span class="normal">657</span>
<span class="normal">658</span>
<span class="normal">659</span>
<span class="normal">660</span>
<span class="normal">661</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@timeout_wrapper</span>
<span class="k">async</span> <span class="k">def</span> <span class="nf">send_inputs_interact</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">interact_events</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">Tuple</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">,</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">bool</span><span class="p">]]],</span>
    <span class="o">*</span><span class="p">,</span>
    <span class="n">interaction_complete_patterns</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="nb">bytes</span><span class="p">,</span> <span class="nb">bytes</span><span class="p">]:</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Interact with a device with changing prompts per input.</span>

<span class="sd">    Used to interact with devices where prompts change per input, and where inputs may be hidden</span>
<span class="sd">    such as in the case of a password input. This can be used to respond to challenges from</span>
<span class="sd">    devices such as the confirmation for the command &quot;clear logging&quot; on IOSXE devices for</span>
<span class="sd">    example. You may have as many elements in the &quot;interact_events&quot; list as needed, and each</span>
<span class="sd">    element of that list should be a tuple of two or three elements. The first element is always</span>
<span class="sd">    the input to send as a string, the second should be the expected response as a string, and</span>
<span class="sd">    the optional third a bool for whether or not the input is &quot;hidden&quot; (i.e. password input)</span>

<span class="sd">    An example where we need this sort of capability:</span>

<span class="sd">    &#39;&#39;&#39;</span>
<span class="sd">    3560CX#copy flash: scp:</span>
<span class="sd">    Source filename []? test1.txt</span>
<span class="sd">    Address or name of remote host []? 172.31.254.100</span>
<span class="sd">    Destination username [carl]?</span>
<span class="sd">    Writing test1.txt</span>
<span class="sd">    Password:</span>

<span class="sd">    Password:</span>
<span class="sd">     Sink: C0644 639 test1.txt</span>
<span class="sd">    !</span>
<span class="sd">    639 bytes copied in 12.066 secs (53 bytes/sec)</span>
<span class="sd">    3560CX#</span>
<span class="sd">    &#39;&#39;&#39;</span>

<span class="sd">    To accomplish this we can use the following:</span>

<span class="sd">    &#39;&#39;&#39;</span>
<span class="sd">    interact = conn.channel.send_inputs_interact(</span>
<span class="sd">        [</span>
<span class="sd">            (&quot;copy flash: scp:&quot;, &quot;Source filename []?&quot;, False),</span>
<span class="sd">            (&quot;test1.txt&quot;, &quot;Address or name of remote host []?&quot;, False),</span>
<span class="sd">            (&quot;172.31.254.100&quot;, &quot;Destination username [carl]?&quot;, False),</span>
<span class="sd">            (&quot;carl&quot;, &quot;Password:&quot;, False),</span>
<span class="sd">            (&quot;super_secure_password&quot;, prompt, True),</span>
<span class="sd">        ]</span>
<span class="sd">    )</span>
<span class="sd">    &#39;&#39;&#39;</span>

<span class="sd">    If we needed to deal with more prompts we could simply continue adding tuples to the list of</span>
<span class="sd">    interact &quot;events&quot;.</span>

<span class="sd">    Args:</span>
<span class="sd">        interact_events: list of tuples containing the &quot;interactions&quot; with the device</span>
<span class="sd">            each list element must have an input and an expected response, and may have an</span>
<span class="sd">            optional bool for the third and final element -- the optional bool specifies if the</span>
<span class="sd">            input that is sent to the device is &quot;hidden&quot; (ex: password), if the hidden param is</span>
<span class="sd">            not provided it is assumed the input is &quot;normal&quot; (not hidden)</span>
<span class="sd">        interaction_complete_patterns: list of patterns, that if seen, indicate the interactive</span>
<span class="sd">            &quot;session&quot; has ended and we should exit the interactive session.</span>

<span class="sd">    Returns:</span>
<span class="sd">        Tuple[bytes, bytes]: output read from the channel with no whitespace trimming/cleaning,</span>
<span class="sd">            and the output read from the channel that has been &quot;cleaned up&quot;</span>

<span class="sd">    Raises:</span>
<span class="sd">        N/A</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_pre_send_inputs_interact</span><span class="p">(</span><span class="n">interact_events</span><span class="o">=</span><span class="n">interact_events</span><span class="p">)</span>

    <span class="n">buf</span> <span class="o">=</span> <span class="sa">b</span><span class="s2">&quot;&quot;</span>
    <span class="n">processed_buf</span> <span class="o">=</span> <span class="sa">b</span><span class="s2">&quot;&quot;</span>

    <span class="k">async</span> <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">_channel_lock</span><span class="p">():</span>
        <span class="k">for</span> <span class="n">interact_event</span> <span class="ow">in</span> <span class="n">interact_events</span><span class="p">:</span>
            <span class="n">channel_input</span> <span class="o">=</span> <span class="n">interact_event</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="n">bytes_channel_input</span> <span class="o">=</span> <span class="n">channel_input</span><span class="o">.</span><span class="n">encode</span><span class="p">()</span>
            <span class="n">channel_response</span> <span class="o">=</span> <span class="n">interact_event</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
            <span class="n">prompts</span> <span class="o">=</span> <span class="p">[</span><span class="n">channel_response</span><span class="p">]</span>

            <span class="k">if</span> <span class="n">interaction_complete_patterns</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">prompts</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">interaction_complete_patterns</span><span class="p">)</span>

            <span class="k">try</span><span class="p">:</span>
                <span class="n">hidden_input</span> <span class="o">=</span> <span class="n">interact_event</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
            <span class="k">except</span> <span class="ne">IndexError</span><span class="p">:</span>
                <span class="n">hidden_input</span> <span class="o">=</span> <span class="kc">False</span>

            <span class="n">_channel_input</span> <span class="o">=</span> <span class="n">channel_input</span> <span class="k">if</span> <span class="ow">not</span> <span class="n">hidden_input</span> <span class="k">else</span> <span class="s2">&quot;REDACTED&quot;</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;sending interactive input: </span><span class="si">{</span><span class="n">_channel_input</span><span class="si">}</span><span class="s2">; &quot;</span>
                <span class="sa">f</span><span class="s2">&quot;expecting: </span><span class="si">{</span><span class="n">channel_response</span><span class="si">}</span><span class="s2">; &quot;</span>
                <span class="sa">f</span><span class="s2">&quot;hidden_input: </span><span class="si">{</span><span class="n">hidden_input</span><span class="si">}</span><span class="s2">&quot;</span>
            <span class="p">)</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">channel_input</span><span class="o">=</span><span class="n">channel_input</span><span class="p">,</span> <span class="n">redacted</span><span class="o">=</span><span class="nb">bool</span><span class="p">(</span><span class="n">hidden_input</span><span class="p">))</span>
            <span class="k">if</span> <span class="n">channel_response</span> <span class="ow">and</span> <span class="n">hidden_input</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">True</span><span class="p">:</span>
                <span class="n">buf</span> <span class="o">+=</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_read_until_input</span><span class="p">(</span><span class="n">channel_input</span><span class="o">=</span><span class="n">bytes_channel_input</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">send_return</span><span class="p">()</span>
            <span class="n">buf</span> <span class="o">+=</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_read_until_explicit_prompt</span><span class="p">(</span><span class="n">prompts</span><span class="o">=</span><span class="n">prompts</span><span class="p">)</span>

    <span class="n">processed_buf</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_process_output</span><span class="p">(</span>
        <span class="n">buf</span><span class="o">=</span><span class="n">buf</span><span class="p">,</span>
        <span class="n">strip_prompt</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="k">return</span> <span class="n">buf</span><span class="p">,</span> <span class="n">processed_buf</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>



  </div>

  </div>

</div>




  </div>

  </div>

</div>





                
              </article>
            </div>
          
          
        </div>
        
      </main>
      
        <footer class="md-footer">
  
    
    <nav class="md-footer__inner md-grid" aria-label="Footer" >
      
        
        <a href="../" class="md-footer__link md-footer__link--prev" aria-label="Previous: channel" rel="prev">
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
          </div>
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Previous
              </span>
              channel
            </div>
          </div>
        </a>
      
      
        
        <a href="../base_channel/" class="md-footer__link md-footer__link--next" aria-label="Next: base_channel" rel="next">
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Next
              </span>
              base_channel
            </div>
          </div>
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4Z"/></svg>
          </div>
        </a>
      
    </nav>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
        <div class="md-social">
  
    
    
      
      
    
    <a href="https://github.com/carlmontanari/" target="_blank" rel="noopener" title="github.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 480 512"><!--! Font Awesome Free 6.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M186.1 328.7c0 20.9-10.9 55.1-36.7 55.1s-36.7-34.2-36.7-55.1 10.9-55.1 36.7-55.1 36.7 34.2 36.7 55.1zM480 278.2c0 31.9-3.2 65.7-17.5 95-37.9 76.6-142.1 74.8-216.7 74.8-75.8 0-186.2 2.7-225.6-74.8-14.6-29-20.2-63.1-20.2-95 0-41.9 13.9-81.5 41.5-113.6-5.2-15.8-7.7-32.4-7.7-48.8 0-21.5 4.9-32.3 14.6-51.8 45.3 0 74.3 9 108.8 36 29-6.9 58.8-10 88.7-10 27 0 54.2 2.9 80.4 9.2 34-26.7 63-35.2 107.8-35.2 9.8 19.5 14.6 30.3 14.6 51.8 0 16.4-2.6 32.7-7.7 48.2 27.5 32.4 39 72.3 39 114.2zm-64.3 50.5c0-43.9-26.7-82.6-73.5-82.6-18.9 0-37 3.4-56 6-14.9 2.3-29.8 3.2-45.1 3.2-15.2 0-30.1-.9-45.1-3.2-18.7-2.6-37-6-56-6-46.8 0-73.5 38.7-73.5 82.6 0 87.8 80.4 101.3 150.4 101.3h48.2c70.3 0 150.6-13.4 150.6-101.3zm-82.6-55.1c-25.8 0-36.7 34.2-36.7 55.1s10.9 55.1 36.7 55.1 36.7-34.2 36.7-55.1-10.9-55.1-36.7-55.1z"/></svg>
    </a>
  
    
    
      
      
    
    <a href="https://twitter.com/carlrmontanari" target="_blank" rel="noopener" title="twitter.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 6.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M459.37 151.716c.325 4.548.325 9.097.325 13.645 0 138.72-105.583 298.558-298.558 298.558-59.452 0-114.68-17.219-161.137-47.106 8.447.974 16.568 1.299 25.34 1.299 49.055 0 94.213-16.568 130.274-44.832-46.132-.975-84.792-31.188-98.112-72.772 6.498.974 12.995 1.624 19.818 1.624 9.421 0 18.843-1.3 27.614-3.573-48.081-9.747-84.143-51.98-84.143-102.985v-1.299c13.969 7.797 30.214 12.67 47.431 13.319-28.264-18.843-46.781-51.005-46.781-87.391 0-19.492 5.197-37.36 14.294-52.954 51.655 63.675 129.3 105.258 216.365 109.807-1.624-7.797-2.599-15.918-2.599-24.04 0-57.828 46.782-104.934 104.934-104.934 30.213 0 57.502 12.67 76.67 33.137 23.715-4.548 46.456-13.32 66.599-25.34-7.798 24.366-24.366 44.833-46.132 57.827 21.117-2.273 41.584-8.122 60.426-16.243-14.292 20.791-32.161 39.308-52.628 54.253z"/></svg>
    </a>
  
    
    
      
      
    
    <a href="https://www.linkedin.com/in/carl-montanari-47888931/" target="_blank" rel="noopener" title="www.linkedin.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M416 32H31.9C14.3 32 0 46.5 0 64.3v383.4C0 465.5 14.3 480 31.9 480H416c17.6 0 32-14.5 32-32.3V64.3c0-17.8-14.4-32.3-32-32.3zM135.4 416H69V202.2h66.5V416zm-33.2-243c-21.3 0-38.5-17.3-38.5-38.5S80.9 96 102.2 96c21.2 0 38.5 17.3 38.5 38.5 0 21.3-17.2 38.5-38.5 38.5zm282.1 243h-66.4V312c0-24.8-.5-56.7-34.5-56.7-34.6 0-39.9 27-39.9 54.9V416h-66.4V202.2h63.7v29.2h.9c8.9-16.8 30.6-34.5 62.9-34.5 67.2 0 79.7 44.3 79.7 101.9V416z"/></svg>
    </a>
  
    
    
      
      
    
    <a href="https://montanari.io" target="_blank" rel="noopener" title="montanari.io" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 6.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M352 256c0 22.2-1.2 43.6-3.3 64H163.3c-2.2-20.4-3.3-41.8-3.3-64s1.2-43.6 3.3-64h185.4c2.2 20.4 3.3 41.8 3.3 64zm28.8-64h123.1c5.3 20.5 8.1 41.9 8.1 64s-2.8 43.5-8.1 64H380.8c2.1-20.6 3.2-42 3.2-64s-1.1-43.4-3.2-64zm112.6-32H376.7c-10-63.9-29.8-117.4-55.3-151.6 78.3 20.7 142 77.5 171.9 151.6zm-149.1 0H167.7c6.1-36.4 15.5-68.6 27-94.7 10.5-23.6 22.2-40.7 33.5-51.5C239.4 3.2 248.7 0 256 0s16.6 3.2 27.8 13.8c11.3 10.8 23 27.9 33.5 51.5 11.6 26 21 58.2 27 94.7zm-209 0H18.6c30-74.1 93.6-130.9 172-151.6-25.5 34.2-45.3 87.7-55.3 151.6zM8.1 192h123.1c-2.1 20.6-3.2 42-3.2 64s1.1 43.4 3.2 64H8.1C2.8 299.5 0 278.1 0 256s2.8-43.5 8.1-64zm186.6 254.6c-11.6-26-20.9-58.2-27-94.6h176.6c-6.1 36.4-15.5 68.6-27 94.6-10.5 23.6-22.2 40.7-33.5 51.5-11.2 10.7-20.5 13.9-27.8 13.9s-16.6-3.2-27.8-13.8c-11.3-10.8-23-27.9-33.5-51.5zM135.3 352c10 63.9 29.8 117.4 55.3 151.6-78.4-20.7-142-77.5-172-151.6h116.7zm358.1 0c-30 74.1-93.6 130.9-171.9 151.6 25.5-34.2 45.2-87.7 55.3-151.6h116.6z"/></svg>
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    <script id="__config" type="application/json">{"base": "../../..", "features": [], "search": "../../../assets/javascripts/workers/search.5bf1dace.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version.title": "Select version"}}</script>
    
    
      <script src="../../../assets/javascripts/bundle.37e9125f.min.js"></script>
      
    
  </body>
</html>